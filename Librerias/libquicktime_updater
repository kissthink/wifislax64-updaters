#!/bin/sh

# Script by www.seguridadwireless.net

SCRIPT_VERSION=20170309

############################################################
## Funciones comunes. Su nombre empieza por f_ ##
############################################################
f_variables(){
	. /opt/wifislax-updaters/Funciones/funciones_updater
}

############################################################
## Funciones propias del script. Su nombre empieza por F_ ##
############################################################
# Definicion de variables
F_variables() {
	PRGNAM=libquicktime
	echo -ne "\033]2;${PRGNAM}_updater\007"
	WEB=http://downloads.sourceforge.net/$PRGNAM/
	VERSION=1.2.4
	EXTENSION=tar.gz
	SOURCES=$PRGNAM-$VERSION.$EXTENSION
	DOWNLOAD=$WEB/$SOURCES
}

# Comprobar dependencias
F_dependencias(){
DEPENDENCIAS="libmp4v2 faac faad2 ffmpeg lame libdv schroedinger x264"
f_dependencias
}

# Descomprimimos el fichero descargado y compilamos
F_compilar(){
echo 
echo "$VERDE"Configurando ..."$CIERRE"
sleep 1

echo "U3VibWl0dGVkIEJ5OiAgICAgICAgICAgIEFybWluIEsuIDxrcmVqemkgYXQgbWFpbCBkb3QgY29t
PgpEYXRlOiAgICAgICAgICAgICAgICAgICAgMjAxNi0wNS0wNApJbml0aWFsIFBhY2thZ2UgVmVy
c2lvbjogMS4yLjQKVXBzdHJlYW0gU3RhdHVzOiAgICAgICAgIEZpeGVkCk9yaWdpbjogICAgICAg
ICAgICAgICAgICBHZW50b28gYW5kIERlYmlhbgpEZXNjcmlwdGlvbjogICAgICAgICAgICAgRml4
ZXMgYnVpbGRpbmcgYWdhaW5zdCBGRm1wZWcgdmVyc2lvbiA+PSAzLjAuMAoKLS0tIGEvcGx1Z2lu
cy9mZm1wZWcvYXVkaW8uYwkyMDEyLTAzLTI5IDIxOjQ0OjI4LjAwMDAwMDAwMCArMDIwMAorKysg
Yi9wbHVnaW5zL2ZmbXBlZy9hdWRpby5jCTIwMTYtMDItMTUgMTY6MTc6MDkuOTc3NDE1NDA1ICsw
MTAwCkBAIC00NSw2ICs0NSwxMSBAQAogI2RlZmluZSBFTkNPREVfQVVESU8gMQogI2VuZGlmCiAK
KyNpZm5kZWYgQVZDT0RFQ19NQVhfQVVESU9fRlJBTUVfU0laRQorLyogZnJvbSBsaWJhdmNvZGVj
L2F2Y29kZWMuaCBkYXRlZCBEZWMgMjMgMjAxMiAqLworI2RlZmluZSBBVkNPREVDX01BWF9BVURJ
T19GUkFNRV9TSVpFIDE5MjAwMCAvLyAxIHNlY29uZCBvZiA0OGtoeiAzMmJpdCBhdWRpbworI2Vu
ZGlmCisKIC8qIFRoZSBmb2xsb3dpbmcgY29kZSB3YXMgcG9ydGVkIGZyb20gZ21lcmxpbl9hdmRl
Y29kZXIgKGh0dHA6Ly9nbWVybGluLnNvdXJjZWZvcmdlLm5ldCkgKi8KIAogLyogTVBFRyBBdWRp
byBoZWFkZXIgcGFyc2luZyBjb2RlICovCkBAIC02MjYsNyArNjMxLDcgQEAKICAgICB7CiAgICAg
LyogSWYgdGhlIGNvZGVjIGlzIG1wMywgbWFrZSBzdXJlIHRvIGRlY29kZSB0aGUgdmVyeSBsYXN0
IGZyYW1lICovCiAKLSAgICBpZigoY29kZWMtPmF2Y3R4LT5jb2RlY19pZCA9PSBDT0RFQ19JRF9N
UDMpICYmCisgICAgaWYoKGNvZGVjLT5hdmN0eC0+Y29kZWNfaWQgPT0gQVZfQ09ERUNfSURfTVAz
KSAmJgogICAgICAgIChjb2RlYy0+Ynl0ZXNfaW5fY2h1bmtfYnVmZmVyID49IDQpKQogICAgICAg
ewogICAgICAgaWYoIW1wYV9kZWNvZGVfaGVhZGVyKCZtcGgsIGNvZGVjLT5jaHVua19idWZmZXIs
IChjb25zdCBtcGFfaGVhZGVyKikwKSkKQEAgLTY5NSw3ICs3MDAsNyBAQAogICAgIAogICAgIC8q
IFNvbWUgcmVhbGx5IGJyb2tlbiBtcDMgZmlsZXMgaGF2ZSB0aGUgaGVhZGVyIGJ5dGVzIHNwbGl0
IGFjcm9zcyAyIGNodW5rcyAqLwogCi0gICAgaWYoY29kZWMtPmF2Y3R4LT5jb2RlY19pZCA9PSBD
T0RFQ19JRF9NUDMpCisgICAgaWYoY29kZWMtPmF2Y3R4LT5jb2RlY19pZCA9PSBBVl9DT0RFQ19J
RF9NUDMpCiAgICAgICB7CiAgICAgICBpZihjb2RlYy0+Ynl0ZXNfaW5fY2h1bmtfYnVmZmVyIDwg
NCkKICAgICAgICAgewpAQCAtODA2LDcgKzgxMSw3IEBACiAgICAgCiAgICAgaWYoYnl0ZXNfZGVj
b2RlZCA8IDApCiAgICAgICB7Ci0gICAgICBpZihjb2RlYy0+YXZjdHgtPmNvZGVjX2lkID09IENP
REVDX0lEX01QMykKKyAgICAgIGlmKGNvZGVjLT5hdmN0eC0+Y29kZWNfaWQgPT0gQVZfQ09ERUNf
SURfTVAzKQogICAgICAgICB7CiAgICAgICAgIC8qIEZvciBtcDMsIGJ5dGVzX2RlY29kZWQgPCAw
IG1lYW5zLCB0aGF0IHRoZSBmcmFtZSBzaG91bGQgYmUgbXV0ZWQgKi8KICAgICAgICAgbWVtc2V0
KCZjb2RlYy0+c2FtcGxlX2J1ZmZlclt0cmFja19tYXAtPmNoYW5uZWxzICogKGNvZGVjLT5zYW1w
bGVfYnVmZmVyX2VuZCAtCkBAIC04NjYsOCArODcxLDggQEAKICAgcXVpY2t0aW1lX2F1ZGlvX21h
cF90ICp0cmFja19tYXAgPSAmZmlsZS0+YXRyYWNrc1t0cmFja107CiAgIHF1aWNrdGltZV9mZm1w
ZWdfYXVkaW9fY29kZWNfdCAqY29kZWMgPSB0cmFja19tYXAtPmNvZGVjLT5wcml2OwogCi0gIGlm
KChjb2RlYy0+ZGVjb2Rlci0+aWQgPT0gQ09ERUNfSURfTVAyKSB8fAotICAgICAoY29kZWMtPmRl
Y29kZXItPmlkID09IENPREVDX0lEX01QMykpCisgIGlmKChjb2RlYy0+ZGVjb2Rlci0+aWQgPT0g
QVZfQ09ERUNfSURfTVAyKSB8fAorICAgICAoY29kZWMtPmRlY29kZXItPmlkID09IEFWX0NPREVD
X0lEX01QMykpCiAgICAgewogICAgIG1wYV9oZWFkZXIgaDsKICAgICB1aW50MzJfdCBoZWFkZXI7
CkBAIC05MDksNyArOTE0LDcgQEAKICAgICBlbHNlCiAgICAgICB0cmFja19tYXAtPmNpLmJpdHJh
dGUgPSBoLmJpdHJhdGU7CiAgICAgfQotICBlbHNlIGlmKGNvZGVjLT5kZWNvZGVyLT5pZCA9PSBD
T0RFQ19JRF9BQzMpCisgIGVsc2UgaWYoY29kZWMtPmRlY29kZXItPmlkID09IEFWX0NPREVDX0lE
X0FDMykKICAgICB7CiAgICAgYTUyX2hlYWRlciBoOwogICAgIHVpbnQ4X3QgKiBwdHI7CkBAIC05
ODYsNyArOTkxLDcgQEAKICNlbmRpZgogICAgIC8qIFNvbWUgY29kZWNzIG5lZWQgZXh0cmEgc3R1
ZmYgKi8KIAotICAgIGlmKGNvZGVjLT5kZWNvZGVyLT5pZCA9PSBDT0RFQ19JRF9BTEFDKQorICAg
IGlmKGNvZGVjLT5kZWNvZGVyLT5pZCA9PSBBVl9DT0RFQ19JRF9BTEFDKQogICAgICAgewogICAg
ICAgaGVhZGVyID0gcXVpY2t0aW1lX3dhdmVfZ2V0X3VzZXJfYXRvbSh0cmFja19tYXAtPnRyYWNr
LCAiYWxhYyIsICZoZWFkZXJfbGVuKTsKICAgICAgIGlmKGhlYWRlcikKQEAgLTk5NSw3ICsxMDAw
LDcgQEAKICAgICAgICAgY29kZWMtPmF2Y3R4LT5leHRyYWRhdGFfc2l6ZSA9IGhlYWRlcl9sZW47
CiAgICAgICAgIH0KICAgICAgIH0KLSAgICBpZihjb2RlYy0+ZGVjb2Rlci0+aWQgPT0gQ09ERUNf
SURfUURNMikKKyAgICBpZihjb2RlYy0+ZGVjb2Rlci0+aWQgPT0gQVZfQ09ERUNfSURfUURNMikK
ICAgICAgIHsKICAgICAgIGhlYWRlciA9IHF1aWNrdGltZV93YXZlX2dldF91c2VyX2F0b20odHJh
Y2tfbWFwLT50cmFjaywgIlFEQ0EiLCAmaGVhZGVyX2xlbik7CiAgICAgICBpZihoZWFkZXIpCkBA
IC0xMjYxLDcgKzEyNjYsNyBAQAogICAgIHBrdC5kYXRhID0gY29kZWMtPmNodW5rX2J1ZmZlcjsK
ICAgICBwa3Quc2l6ZSA9IGNvZGVjLT5jaHVua19idWZmZXJfYWxsb2M7CiAKLSAgICBhdmNvZGVj
X2dldF9mcmFtZV9kZWZhdWx0cygmZik7CisgICAgYXZfZnJhbWVfdW5yZWYoJmYpOwogICAgIGYu
bmJfc2FtcGxlcyA9IGNvZGVjLT5hdmN0eC0+ZnJhbWVfc2l6ZTsKICAgICAKICAgICBhdmNvZGVj
X2ZpbGxfYXVkaW9fZnJhbWUoJmYsIGNoYW5uZWxzLCBjb2RlYy0+YXZjdHgtPnNhbXBsZV9mbXQs
CkBAIC0xNDk1LDkgKzE1MDAsOSBAQAogICAgIGNvZGVjX2Jhc2UtPmRlY29kZV9hdWRpbyA9IGxx
dF9mZm1wZWdfZGVjb2RlX2F1ZGlvOwogICBjb2RlY19iYXNlLT5zZXRfcGFyYW1ldGVyID0gc2V0
X3BhcmFtZXRlcjsKIAotICBpZigoZGVjb2Rlci0+aWQgPT0gQ09ERUNfSURfTVAzKSB8fCAoZGVj
b2Rlci0+aWQgPT0gQ09ERUNfSURfTVAyKSkKKyAgaWYoKGRlY29kZXItPmlkID09IEFWX0NPREVD
X0lEX01QMykgfHwgKGRlY29kZXItPmlkID09IEFWX0NPREVDX0lEX01QMikpCiAgICAgY29kZWNf
YmFzZS0+cmVhZF9wYWNrZXQgPSByZWFkX3BhY2tldF9tcGE7Ci0gIGVsc2UgaWYoZGVjb2Rlci0+
aWQgPT0gQ09ERUNfSURfQUMzKQorICBlbHNlIGlmKGRlY29kZXItPmlkID09IEFWX0NPREVDX0lE
X0FDMykKICAgICB7CiAgICAgY29kZWNfYmFzZS0+d3JpdGVfcGFja2V0ID0gd3JpdGVfcGFja2V0
X2FjMzsKICAgICBjb2RlY19iYXNlLT5yZWFkX3BhY2tldCA9IHJlYWRfcGFja2V0X2FjMzsKLS0t
IGEvcGx1Z2lucy9mZm1wZWcvZmZtcGVnLmgJMjAxMi0wMi0xNSAyMDo0ODozMC4wMDAwMDAwMDAg
KzAxMDAKKysrIGIvcGx1Z2lucy9mZm1wZWcvZmZtcGVnLmgJMjAxNi0wMi0xNSAxNjoxNTowOC4x
MTQ4OTcwODkgKzAxMDAKQEAgLTI3LDYgKzI3LDcgQEAKIAogI2luY2x1ZGUgPHF1aWNrdGltZS9x
dHByaXZhdGUuaD4KICNpbmNsdWRlIEFWQ09ERUNfSEVBREVSCisjaW5jbHVkZSA8bGliYXZ1dGls
L21lbS5oPgogCiB2b2lkIHF1aWNrdGltZV9pbml0X3ZpZGVvX2NvZGVjX2ZmbXBlZyhxdWlja3Rp
bWVfY29kZWNfdCAqIGNvZGVjLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgcXVpY2t0aW1lX3ZpZGVvX21hcF90ICp2dHJhY2ssCi0tLSBhL3BsdWdpbnMvZmZtcGVnL2xx
dF9mZm1wZWcuYwkyMDEyLTAyLTE1IDIwOjQ4OjMwLjAwMDAwMDAwMCArMDEwMAorKysgYi9wbHVn
aW5zL2ZmbXBlZy9scXRfZmZtcGVnLmMJMjAxNi0wMi0xNSAxNjoxNzowOS45NzM0MTUzMjMgKzAx
MDAKQEAgLTM4Niw3ICszODYsNyBAQAogc3RydWN0IENPREVDSURNQVAgY29kZWNpZG1hcF92W10g
PQogICB7CiAgICAgewotICAgICAgLmlkID0gQ09ERUNfSURfTVBFRzFWSURFTywKKyAgICAgIC5p
ZCA9IEFWX0NPREVDX0lEX01QRUcxVklERU8sCiAgICAgICAuaW5kZXggPSAtMSwKICAgICAgIC5l
bmNvZGVyID0gTlVMTCwKICAgICAgIC5kZWNvZGVyID0gTlVMTCwKQEAgLTM5Nyw3ICszOTcsNyBA
QAogICAgICAgLndhdl9pZHMgPSB7IExRVF9XQVZfSURfTk9ORSB9CiAgICAgfSwKICAgICB7Ci0g
ICAgICAuaWQgPSBDT0RFQ19JRF9NUEVHNCwKKyAgICAgIC5pZCA9IEFWX0NPREVDX0lEX01QRUc0
LAogICAgICAgLmluZGV4ID0gLTEsCiAgICAgICAuZW5jb2RlciA9IE5VTEwsCiAgICAgICAuZGVj
b2RlciA9IE5VTEwsCkBAIC00MTUsNyArNDE1LDcgQEAKICAgICAgIC5jb21wcmVzc2lvbl9pZCA9
IExRVF9DT01QUkVTU0lPTl9NUEVHNF9BU1AsCiAgICAgfSwKICAgICB7Ci0gICAgICAuaWQgPSBD
T0RFQ19JRF9NU01QRUc0VjEsCisgICAgICAuaWQgPSBBVl9DT0RFQ19JRF9NU01QRUc0VjEsCiAg
ICAgICAuaW5kZXggPSAtMSwKICAgICAgIC5lbmNvZGVyID0gTlVMTCwKICAgICAgIC5kZWNvZGVy
ID0gTlVMTCwKQEAgLTQyNiw3ICs0MjYsNyBAQAogICAgICAgLndhdl9pZHMgPSB7IExRVF9XQVZf
SURfTk9ORSB9LAogICAgIH0sCiAgICAgewotICAgICAgLmlkID0gQ09ERUNfSURfTVNNUEVHNFYy
LAorICAgICAgLmlkID0gQVZfQ09ERUNfSURfTVNNUEVHNFYyLAogICAgICAgLmluZGV4ID0gLTEs
CiAgICAgICAuZW5jb2RlciA9IE5VTEwsCiAgICAgICAuZGVjb2RlciA9IE5VTEwsCkBAIC00Mzcs
NyArNDM3LDcgQEAKICAgICAgIC53YXZfaWRzID0geyBMUVRfV0FWX0lEX05PTkUgfSwKICAgICB9
LAogICAgIHsKLSAgICAgIC5pZCA9IENPREVDX0lEX01TTVBFRzRWMywKKyAgICAgIC5pZCA9IEFW
X0NPREVDX0lEX01TTVBFRzRWMywKICAgICAgIC5pbmRleCA9IC0xLAogICAgICAgLmVuY29kZXIg
PSBOVUxMLAogICAgICAgLmRlY29kZXIgPSBOVUxMLApAQCAtNDUzLDcgKzQ1Myw3IEBACiAgICAg
ICAuZG9fZW5jb2RlID0gMSwKICAgICB9LAogICAgIHsKLSAgICAgIC5pZCA9IENPREVDX0lEX01T
TVBFRzRWMywKKyAgICAgIC5pZCA9IEFWX0NPREVDX0lEX01TTVBFRzRWMywKICAgICAgIC5pbmRl
eCA9IC0xLAogICAgICAgLmVuY29kZXIgPSBOVUxMLAogICAgICAgLmRlY29kZXIgPSBOVUxMLApA
QCAtNDY4LDcgKzQ2OCw3IEBACiAgICAgfSwKICNpZiAwCiAgICAgewotICAgICAgLmlkID0gQ09E
RUNfSURfV01WMSwKKyAgICAgIC5pZCA9IEFWX0NPREVDX0lEX1dNVjEsCiAgICAgICAuaW5kZXgg
PSAtMSwKICAgICAgIC5lbmNvZGVyID0gTlVMTCwKICAgICAgIC5kZWNvZGVyID0gTlVMTCwKQEAg
LTQ4MSw3ICs0ODEsNyBAQAogICAgIH0sCiAjZW5kaWYKICAgICB7Ci0gICAgICAuaWQgPSBDT0RF
Q19JRF9IMjYzLAorICAgICAgLmlkID0gQVZfQ09ERUNfSURfSDI2MywKICAgICAgIC5pbmRleCA9
IC0xLAogICAgICAgLmVuY29kZXIgPSBOVUxMLAogICAgICAgLmRlY29kZXIgPSBOVUxMLApAQCAt
NDkzLDcgKzQ5Myw3IEBACiAgICAgICAuY29tcGF0aWJpbGl0eV9mbGFncyA9IExRVF9GSUxFX1FU
X09MRCB8IExRVF9GSUxFX1FUIHwgTFFUX0ZJTEVfTVA0IHwgTFFUX0ZJTEVfM0dQLAogICAgIH0s
CiAgICAgewotICAgICAgLmlkID0gQ09ERUNfSURfSDI2MywKKyAgICAgIC5pZCA9IEFWX0NPREVD
X0lEX0gyNjMsCiAgICAgICAuaW5kZXggPSAtMSwKICAgICAgIC5lbmNvZGVyID0gTlVMTCwKICAg
ICAgIC5kZWNvZGVyID0gTlVMTCwKQEAgLTUwOCw3ICs1MDgsNyBAQAogICAgICAgLmRvX2VuY29k
ZSA9IDEsCiAgICAgfSwKICAgICB7Ci0gICAgICAuaWQgPSBDT0RFQ19JRF9IMjY0LAorICAgICAg
LmlkID0gQVZfQ09ERUNfSURfSDI2NCwKICAgICAgIC5pbmRleCA9IC0xLAogICAgICAgLmVuY29k
ZXIgPSBOVUxMLAogICAgICAgLmRlY29kZXIgPSBOVUxMLApAQCAtNTE5LDcgKzUxOSw3IEBACiAg
ICAgICAud2F2X2lkcyA9IHsgTFFUX1dBVl9JRF9OT05FIH0sCiAgICAgfSwKICAgICB7Ci0gICAg
ICAuaWQgPSBDT0RFQ19JRF9IMjYzUCwKKyAgICAgIC5pZCA9IEFWX0NPREVDX0lEX0gyNjNQLAog
ICAgICAgLmluZGV4ID0gLTEsCiAgICAgICAuZW5jb2RlciA9IE5VTEwsCiAgICAgICAuZGVjb2Rl
ciA9IE5VTEwsCkBAIC01MzMsNyArNTMzLDcgQEAKICAgICAgIC5kb19lbmNvZGUgPSAxLAogICAg
IH0sCiAgICAgewotICAgICAgLmlkID0gQ09ERUNfSURfSDI2M0ksCisgICAgICAuaWQgPSBBVl9D
T0RFQ19JRF9IMjYzSSwKICAgICAgIC5pbmRleCA9IC0xLAogICAgICAgLmVuY29kZXIgPSBOVUxM
LAogICAgICAgLmRlY29kZXIgPSBOVUxMLApAQCAtNTQ0LDcgKzU0NCw3IEBACiAgICAgICAud2F2
X2lkcyA9IHsgTFFUX1dBVl9JRF9OT05FIH0sCiAgICAgfSwKICAgICB7Ci0gICAgICAuaWQgPSBD
T0RFQ19JRF9TVlExLAorICAgICAgLmlkID0gQVZfQ09ERUNfSURfU1ZRMSwKICAgICAgIC5pbmRl
eCA9IC0xLAogICAgICAgLmVuY29kZXIgPSBOVUxMLAogICAgICAgLmRlY29kZXIgPSBOVUxMLApA
QCAtNTU1LDcgKzU1NSw3IEBACiAgICAgICAud2F2X2lkcyA9IHsgTFFUX1dBVl9JRF9OT05FIH0s
CiAgICAgfSwKICAgICB7Ci0gICAgICAuaWQgPSBDT0RFQ19JRF9TVlEzLAorICAgICAgLmlkID0g
QVZfQ09ERUNfSURfU1ZRMywKICAgICAgIC5pbmRleCA9IC0xLAogICAgICAgLmVuY29kZXIgPSBO
VUxMLAogICAgICAgLmRlY29kZXIgPSBOVUxMLApAQCAtNTY2LDcgKzU2Niw3IEBACiAgICAgICAu
d2F2X2lkcyA9IHsgTFFUX1dBVl9JRF9OT05FIH0sCiAgICAgfSwKICAgICB7Ci0gICAgICAuaWQg
PSBDT0RFQ19JRF9NSlBFRywKKyAgICAgIC5pZCA9IEFWX0NPREVDX0lEX01KUEVHLAogICAgICAg
LmluZGV4ID0gLTEsCiAgICAgICAuZW5jb2RlciA9IE5VTEwsCiAgICAgICAuZGVjb2RlciA9IE5V
TEwsCkBAIC01ODAsNyArNTgwLDcgQEAKICAgICAgIC5kb19lbmNvZGUgPSAxLAogICAgIH0sCiAg
ICAgewotICAgICAgLmlkID0gQ09ERUNfSURfTUpQRUdCLAorICAgICAgLmlkID0gQVZfQ09ERUNf
SURfTUpQRUdCLAogICAgICAgLmluZGV4ID0gLTEsCiAgICAgICAuZW5jb2RlciA9IE5VTEwsCiAg
ICAgICAuZGVjb2RlciA9IE5VTEwsCkBAIC01OTQsNyArNTk0LDcgQEAKICAgICB9LAogI2lmIExJ
QkFWQ09ERUNfQlVJTEQgPj0gMzM0NjY4OAogICAgIHsKLSAgICAgIC5pZCA9IENPREVDX0lEX1RB
UkdBLAorICAgICAgLmlkID0gQVZfQ09ERUNfSURfVEFSR0EsCiAgICAgICAuaW5kZXggPSAtMSwK
ICAgICAgIC5lbmNvZGVyID0gTlVMTCwKICAgICAgIC5kZWNvZGVyID0gTlVMTCwKQEAgLTYwNiw3
ICs2MDYsNyBAQAogI2VuZGlmCiAjaWYgTElCQVZDT0RFQ19CVUlMRCA+PSAzMzQ3NDU2CiAgICAg
ewotICAgICAgLmlkID0gQ09ERUNfSURfVElGRiwKKyAgICAgIC5pZCA9IEFWX0NPREVDX0lEX1RJ
RkYsCiAgICAgICAuaW5kZXggPSAtMSwKICAgICAgIC5lbmNvZGVyID0gTlVMTCwKICAgICAgIC5k
ZWNvZGVyID0gTlVMTCwKQEAgLTYxNyw3ICs2MTcsNyBAQAogICAgIH0sCiAjZW5kaWYKICAgICB7
Ci0gICAgICAuaWQgPSBDT0RFQ19JRF84QlBTLAorICAgICAgLmlkID0gQVZfQ09ERUNfSURfOEJQ
UywKICAgICAgIC5pbmRleCA9IC0xLAogICAgICAgLmVuY29kZXIgPSBOVUxMLAogICAgICAgLmRl
Y29kZXIgPSBOVUxMLApAQCAtNjI3LDcgKzYyNyw3IEBACiAgICAgICAud2F2X2lkcyA9IHsgTFFU
X1dBVl9JRF9OT05FIH0sCiAgICAgfSwKICAgICB7Ci0gICAgICAuaWQgPSBDT0RFQ19JRF9JTkRF
TzMsCisgICAgICAuaWQgPSBBVl9DT0RFQ19JRF9JTkRFTzMsCiAgICAgICAuaW5kZXggPSAtMSwK
ICAgICAgIC5lbmNvZGVyID0gTlVMTCwKICAgICAgIC5kZWNvZGVyID0gTlVMTCwKQEAgLTYzOCw3
ICs2MzgsNyBAQAogICAgICAgLndhdl9pZHMgPSB7IExRVF9XQVZfSURfTk9ORSB9LAogICAgIH0s
CiAgICAgewotICAgICAgLmlkID0gQ09ERUNfSURfUlBaQSwKKyAgICAgIC5pZCA9IEFWX0NPREVD
X0lEX1JQWkEsCiAgICAgICAuaW5kZXggPSAtMSwKICAgICAgIC5lbmNvZGVyID0gTlVMTCwKICAg
ICAgIC5kZWNvZGVyID0gTlVMTCwKQEAgLTY0OCw3ICs2NDgsNyBAQAogICAgICAgLndhdl9pZHMg
PSB7IExRVF9XQVZfSURfTk9ORSB9LAogICAgIH0sCiAgICAgewotICAgICAgLmlkID0gQ09ERUNf
SURfU01DLAorICAgICAgLmlkID0gQVZfQ09ERUNfSURfU01DLAogICAgICAgLmluZGV4ID0gLTEs
CiAgICAgICAuZW5jb2RlciA9IE5VTEwsCiAgICAgICAuZGVjb2RlciA9IE5VTEwsCkBAIC02NTgs
NyArNjU4LDcgQEAKICAgICAgIC53YXZfaWRzID0geyBMUVRfV0FWX0lEX05PTkUgfSwKICAgICB9
LAogICAgIHsKLSAgICAgIC5pZCA9IENPREVDX0lEX0NJTkVQQUssCisgICAgICAuaWQgPSBBVl9D
T0RFQ19JRF9DSU5FUEFLLAogICAgICAgLmluZGV4ID0gLTEsCiAgICAgICAuZW5jb2RlciA9IE5V
TEwsCiAgICAgICAuZGVjb2RlciA9IE5VTEwsCkBAIC02NjksNyArNjY5LDcgQEAKICAgICAgIC53
YXZfaWRzID0geyBMUVRfV0FWX0lEX05PTkUgfSwKICAgICB9LAogICAgIHsKLSAgICAgIC5pZCA9
IENPREVDX0lEX0NZVVYsCisgICAgICAuaWQgPSBBVl9DT0RFQ19JRF9DWVVWLAogICAgICAgLmlu
ZGV4ID0gLTEsCiAgICAgICAuZW5jb2RlciA9IE5VTEwsCiAgICAgICAuZGVjb2RlciA9IE5VTEws
CkBAIC02ODAsNyArNjgwLDcgQEAKICAgICAgIC53YXZfaWRzID0geyBMUVRfV0FWX0lEX05PTkUg
fSwKICAgICB9LAogICAgIHsKLSAgICAgIC5pZCA9IENPREVDX0lEX1FUUkxFLAorICAgICAgLmlk
ID0gQVZfQ09ERUNfSURfUVRSTEUsCiAgICAgICAuaW5kZXggPSAtMSwKICAgICAgIC5lbmNvZGVy
ID0gTlVMTCwKICAgICAgIC5kZWNvZGVyID0gTlVMTCwKQEAgLTY5Myw3ICs2OTMsNyBAQAogICAg
ICAgLmVuY29kaW5nX2NvbG9ybW9kZWxzID0gKGludFtdKXsgQkNfUkdCODg4LCBCQ19SR0JBODg4
OCwgTFFUX0NPTE9STU9ERUxfTk9ORSB9LAogICAgIH0sCiAgICAgewotICAgICAgLmlkID0gQ09E
RUNfSURfTVNSTEUsCisgICAgICAuaWQgPSBBVl9DT0RFQ19JRF9NU1JMRSwKICAgICAgIC5pbmRl
eCA9IC0xLAogICAgICAgLmVuY29kZXIgPSBOVUxMLAogICAgICAgLmRlY29kZXIgPSBOVUxMLApA
QCAtNzAzLDcgKzcwMyw3IEBACiAgICAgICAud2F2X2lkcyA9IHsgTFFUX1dBVl9JRF9OT05FIH0s
CiAgICAgfSwKICAgICB7Ci0gICAgICAuaWQgPSBDT0RFQ19JRF9EVlZJREVPLAorICAgICAgLmlk
ID0gQVZfQ09ERUNfSURfRFZWSURFTywKICAgICAgIC5pbmRleCA9IC0xLAogICAgICAgLmVuY29k
ZXIgPSBOVUxMLAogICAgICAgLmRlY29kZXIgPSBOVUxMLApAQCAtNzE5LDcgKzcxOSw3IEBACiAg
ICAgICAuaW1hZ2Vfc2l6ZXMgPSBpbWFnZV9zaXplc19kdiwKICAgICB9LAogICAgIHsKLSAgICAg
IC5pZCA9IENPREVDX0lEX0RWVklERU8sCisgICAgICAuaWQgPSBBVl9DT0RFQ19JRF9EVlZJREVP
LAogICAgICAgLmluZGV4ID0gLTEsCiAgICAgICAuZW5jb2RlciA9IE5VTEwsCiAgICAgICAuZGVj
b2RlciA9IE5VTEwsCkBAIC03MzUsNyArNzM1LDcgQEAKICAgICAgIC5pbWFnZV9zaXplcyA9IGlt
YWdlX3NpemVzX2R2LAogICAgIH0sCiAgICAgewotICAgICAgLmlkID0gQ09ERUNfSURfRFZWSURF
TywKKyAgICAgIC5pZCA9IEFWX0NPREVDX0lEX0RWVklERU8sCiAgICAgICAuaW5kZXggPSAtMSwK
ICAgICAgIC5lbmNvZGVyID0gTlVMTCwKICAgICAgIC5kZWNvZGVyID0gTlVMTCwKQEAgLTc1MSw3
ICs3NTEsNyBAQAogICAgIH0sCiAgICAgLyogRFZDUFJPIEhEIChkZWNvZGluZyBvbmx5IGZvciBu
b3cpICovCiAgICAgewotICAgICAgLmlkID0gQ09ERUNfSURfRFZWSURFTywKKyAgICAgIC5pZCA9
IEFWX0NPREVDX0lEX0RWVklERU8sCiAgICAgICAuaW5kZXggPSAtMSwKICAgICAgIC5lbmNvZGVy
ID0gTlVMTCwKICAgICAgIC5kZWNvZGVyID0gTlVMTCwKQEAgLTc3Miw3ICs3NzIsNyBAQAogICAg
ICAgLy8gLmRvX2VuY29kZSA9IDEKICAgICB9LAogICAgIHsKLSAgICAgIC5pZCA9IENPREVDX0lE
X0ZGVkhVRkYsCisgICAgICAuaWQgPSBBVl9DT0RFQ19JRF9GRlZIVUZGLAogICAgICAgLmluZGV4
ID0gLTEsCiAgICAgICAuZW5jb2RlciA9IE5VTEwsCiAgICAgICAuZGVjb2RlciA9IE5VTEwsCkBA
IC03ODUsNyArNzg1LDcgQEAKICAgICAgIC5kb19lbmNvZGUgPSAxCiAgICAgfSwKICAgICB7Ci0g
ICAgICAuaWQgPSBDT0RFQ19JRF9GRlYxLAorICAgICAgLmlkID0gQVZfQ09ERUNfSURfRkZWMSwK
ICAgICAgIC5pbmRleCA9IC0xLAogICAgICAgLmVuY29kZXIgPSBOVUxMLAogICAgICAgLmRlY29k
ZXIgPSBOVUxMLApAQCAtODAxLDcgKzgwMSw3IEBACiAgICAgfSwKICNpZiBMSUJBVkNPREVDX0JV
SUxEID49IDMzNTI1NzYKICAgICB7Ci0gICAgICAuaWQgPSBDT0RFQ19JRF9ETlhIRCwKKyAgICAg
IC5pZCA9IEFWX0NPREVDX0lEX0ROWEhELAogICAgICAgLmluZGV4ID0gLTEsCiAgICAgICAuZW5j
b2RlciA9IE5VTEwsCiAgICAgICAuZGVjb2RlciA9IE5VTEwsCkBAIC04MTcsNyArODE3LDcgQEAK
ICAgICB9LAogI2VuZGlmCiAgICAgewotICAgICAgLmlkID0gQ09ERUNfSURfTVBFRzJWSURFTywK
KyAgICAgIC5pZCA9IEFWX0NPREVDX0lEX01QRUcyVklERU8sCiAgICAgICAuaW5kZXggPSAtMSwK
ICAgICAgIC5lbmNvZGVyID0gTlVMTCwKICAgICAgIC5kZWNvZGVyID0gTlVMTCwKQEAgLTgzOSw3
ICs4MzksNyBAQAogc3RydWN0IENPREVDSURNQVAgY29kZWNpZG1hcF9hW10gPQogICB7CiAgICAg
ewotICAgICAgLmlkID0gQ09ERUNfSURfTVAzLAorICAgICAgLmlkID0gQVZfQ09ERUNfSURfTVAz
LAogICAgICAgLmluZGV4ID0gLTEsCiAgICAgICAuZW5jb2RlciA9IE5VTEwsCiAgICAgICAuZGVj
b2RlciA9IE5VTEwsCkBAIC04NTEsNyArODUxLDcgQEAKICAgICAgIC53YXZfaWRzID0geyAweDUw
LCAweDU1LCBMUVRfV0FWX0lEX05PTkUgfSwKICAgICB9LAogICAgIHsKLSAgICAgIC5pZCA9IENP
REVDX0lEX01QMiwKKyAgICAgIC5pZCA9IEFWX0NPREVDX0lEX01QMiwKICAgICAgIC5pbmRleCA9
IC0xLAogICAgICAgLmVuY29kZXIgPSBOVUxMLAogICAgICAgLmRlY29kZXIgPSBOVUxMLApAQCAt
ODY2LDcgKzg2Niw3IEBACiAgICAgICAuY29tcHJlc3Npb25faWQgPSBMUVRfQ09NUFJFU1NJT05f
TVAyLAogICAgIH0sCiAgICAgewotICAgICAgLmlkID0gQ09ERUNfSURfQUMzLAorICAgICAgLmlk
ID0gQVZfQ09ERUNfSURfQUMzLAogICAgICAgLmluZGV4ID0gLTEsCiAgICAgICAuZW5jb2RlciA9
IE5VTEwsCiAgICAgICAuZGVjb2RlciA9IE5VTEwsCkBAIC04ODEsNyArODgxLDcgQEAKICAgICAg
IC5jb21wcmVzc2lvbl9pZCA9IExRVF9DT01QUkVTU0lPTl9BQzMsCiAgICAgfSwKICAgICB7Ci0g
ICAgICAuaWQgPSBDT0RFQ19JRF9RRE0yLAorICAgICAgLmlkID0gQVZfQ09ERUNfSURfUURNMiwK
ICAgICAgIC5pbmRleCA9IC0xLAogICAgICAgLmVuY29kZXIgPSBOVUxMLAogICAgICAgLmRlY29k
ZXIgPSBOVUxMLApAQCAtODk2LDcgKzg5Niw3IEBACiAjaWYgMQogICAgIC8qIERvZXNuJ3Qgd29y
ayBhcyBsb25nIGFzIGF1ZGlvIGNodW5rcyBhcmUgbm90IHNwbGl0IGludG8gVkJSICJTYW1wbGVz
IiAqLwogICAgIHsKLSAgICAgIC5pZCA9IENPREVDX0lEX0FMQUMsCisgICAgICAuaWQgPSBBVl9D
T0RFQ19JRF9BTEFDLAogICAgICAgLmluZGV4ID0gLTEsCiAgICAgICAuZW5jb2RlciA9IE5VTEws
CiAgICAgICAuZGVjb2RlciA9IE5VTEwsCkBAIC05MDksNyArOTA5LDcgQEAKICNpZiAxCiAgICAg
LyogU291bmRzIHVnbHkgKi8KICAgICB7Ci0gICAgICAuaWQgPSBDT0RFQ19JRF9BRFBDTV9NUywK
KyAgICAgIC5pZCA9IEFWX0NPREVDX0lEX0FEUENNX01TLAogICAgICAgLmluZGV4ID0gLTEsCiAg
ICAgICAuZW5jb2RlciA9IE5VTEwsCiAgICAgICAuZGVjb2RlciA9IE5VTEwsCkBAIC05MjIsNyAr
OTIyLDcgQEAKICNpZiAxCiAgICAgLyogU291bmRzIHVnbHkgKi8KICAgICB7Ci0gICAgICAuaWQg
PSBDT0RFQ19JRF9BRFBDTV9JTUFfV0FWLAorICAgICAgLmlkID0gQVZfQ09ERUNfSURfQURQQ01f
SU1BX1dBViwKICAgICAgIC5pbmRleCA9IC0xLAogICAgICAgLmVuY29kZXIgPSBOVUxMLAogICAg
ICAgLmRlY29kZXIgPSBOVUxMLAotLS0gYS9wbHVnaW5zL2ZmbXBlZy9wYXJhbXMuYwkyMDEyLTAz
LTA3IDE1OjEwOjQxLjAwMDAwMDAwMCArMDEwMAorKysgYi9wbHVnaW5zL2ZmbXBlZy9wYXJhbXMu
YwkyMDE2LTAyLTE1IDE2OjE1OjA4LjExNDg5NzA4OSArMDEwMApAQCAtMTAxLDYgKzEwMSwxNyBA
QAogICAgIH0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAogICB9
CiAKKyNkZWZpbmUgUEFSQU1fRElDVF9JTlQobmFtZSwgZGljdF9uYW1lKSAgICAgICAgICAgICBc
CisgIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAor
ICBpZighc3RyY2FzZWNtcChuYW1lLCBrZXkpKSAgICAgICAgICAgICAgICAgICAgICAgIFwKKyAg
ICB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAg
Y2hhciBidWZbMTI4XTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgIHNu
cHJpbnRmKGJ1Ziwgc2l6ZW9mKGJ1ZiksICIlZCIsICooaW50Kil2YWx1ZSk7IFwKKyAgICBhdl9k
aWN0X3NldChvcHRpb25zLCBkaWN0X25hbWUsIGJ1ZiwgMCk7ICAgICAgICBcCisgICAgZm91bmQg
PSAxOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgIH0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKKyAgfQorCiAjZGVmaW5l
IFBBUkFNX0RJQ1RfRkxBRyhuYW1lLCBkaWN0X25hbWUpICAgICAgICBcCiAgIHsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCiAgIGlmKCFzdHJjYXNlY21wKG5h
bWUsIGtleSkpICAgICAgICAgICAgICAgICAgICBcCkBAIC0yMDIsOCArMjEzLDE1IEBACiAgIFBB
UkFNX0lOVCgiZmZfbWF4X2JfZnJhbWVzIixtYXhfYl9mcmFtZXMpOwogICBQQVJBTV9GTE9BVCgi
ZmZfYl9xdWFudF9mYWN0b3IiLGJfcXVhbnRfZmFjdG9yKTsKICAgUEFSQU1fSU5UKCJmZl9iX2Zy
YW1lX3N0cmF0ZWd5IixiX2ZyYW1lX3N0cmF0ZWd5KTsKKworI2lmIExJQkFWQ09ERUNfVkVSU0lP
Tl9NQUpPUiA+PSA1NQorICBQQVJBTV9ESUNUX0lOVCgiZmZfbHVtYV9lbGltX3RocmVzaG9sZCIs
Imx1bWFfZWxpbV90aHJlc2hvbGQiKTsKKyAgUEFSQU1fRElDVF9JTlQoImZmX2Nocm9tYV9lbGlt
X3RocmVzaG9sZCIsImNocm9tYV9lbGltX3RocmVzaG9sZCIpOworI2Vsc2UKICAgUEFSQU1fSU5U
KCJmZl9sdW1hX2VsaW1fdGhyZXNob2xkIixsdW1hX2VsaW1fdGhyZXNob2xkKTsKICAgUEFSQU1f
SU5UKCJmZl9jaHJvbWFfZWxpbV90aHJlc2hvbGQiLGNocm9tYV9lbGltX3RocmVzaG9sZCk7Cisj
ZW5kaWYKKwogICBQQVJBTV9JTlQoImZmX3N0cmljdF9zdGRfY29tcGxpYW5jZSIsc3RyaWN0X3N0
ZF9jb21wbGlhbmNlKTsKICAgUEFSQU1fUVAyTEFNQkRBKCJmZl9iX3F1YW50X29mZnNldCIsYl9x
dWFudF9vZmZzZXQpOwogICBQQVJBTV9JTlQoImZmX3JjX21pbl9yYXRlIixyY19taW5fcmF0ZSk7
CkBAIC0yNDEsOCArMjU5LDE1IEBACiAgIFBBUkFNX1FQMkxBTUJEQSgiZmZfbG1heCIsIGxtYXgp
OwogICBQQVJBTV9JTlQoImZmX25vaXNlX3JlZHVjdGlvbiIsbm9pc2VfcmVkdWN0aW9uKTsKICAg
UEFSQU1fSU5UX1NDQUxFKCJmZl9yY19pbml0aWFsX2J1ZmZlcl9vY2N1cGFuY3kiLHJjX2luaXRp
YWxfYnVmZmVyX29jY3VwYW5jeSwxMDAwKTsKKworI2lmIExJQkFWQ09ERUNfVkVSU0lPTl9NQUpP
UiA+PSA1NQorICBQQVJBTV9ESUNUX0lOVCgiZmZfaW50ZXJfdGhyZXNob2xkIiwiaW50ZXJfdGhy
ZXNob2xkIik7CisgIFBBUkFNX0RJQ1RfSU5UKCJmZl9xdWFudGl6ZXJfbm9pc2Vfc2hhcGluZyIs
InF1YW50aXplcl9ub2lzZV9zaGFwaW5nIik7CisjZWxzZQogICBQQVJBTV9JTlQoImZmX2ludGVy
X3RocmVzaG9sZCIsaW50ZXJfdGhyZXNob2xkKTsKICAgUEFSQU1fSU5UKCJmZl9xdWFudGl6ZXJf
bm9pc2Vfc2hhcGluZyIscXVhbnRpemVyX25vaXNlX3NoYXBpbmcpOworI2VuZGlmCisKICAgUEFS
QU1fSU5UKCJmZl90aHJlYWRfY291bnQiLHRocmVhZF9jb3VudCk7CiAgIFBBUkFNX0lOVCgiZmZf
bWVfdGhyZXNob2xkIixtZV90aHJlc2hvbGQpOwogICBQQVJBTV9JTlQoImZmX21iX3RocmVzaG9s
ZCIsbWJfdGhyZXNob2xkKTsKQEAgLTI3Miw4ICsyOTcsMTYgQEAKICAgUEFSQU1fRkxBRygiZmZf
ZmxhZ19iaXRleGFjdCIsQ09ERUNfRkxBR19CSVRFWEFDVCk7CiAgIFBBUkFNX0ZMQUcoImZmX2Zs
YWdfYWNfcHJlZCIsQ09ERUNfRkxBR19BQ19QUkVEKTsKICAgLy8gIFBBUkFNX0ZMQUcoImZmX2Zs
YWdfaDI2M3BfdW12IixDT0RFQ19GTEFHX0gyNjNQX1VNVik7IC8vIFVudXNlZAorCisjaWYgTElC
QVZDT0RFQ19WRVJTSU9OX01BSk9SID49IDU1CisgIFBBUkFNX0RJQ1RfRkxBRygiZmZfZmxhZ19j
YnBfcmQiLCJjYnBfcmQiKTsKKyAgUEFSQU1fRElDVF9GTEFHKCJmZl9mbGFnX3FwX3JkIiwicXBf
cmQiKTsKKyAgUEFSQU1fRElDVF9GTEFHKCJmZl9mbGFnMl9zdHJpY3RfZ29wIiwic3RyaWN0X2dv
cCIpOworI2Vsc2UKICAgUEFSQU1fRkxBRygiZmZfZmxhZ19jYnBfcmQiLENPREVDX0ZMQUdfQ0JQ
X1JEKTsKICAgUEFSQU1fRkxBRygiZmZfZmxhZ19xcF9yZCIsQ09ERUNfRkxBR19RUF9SRCk7Cisg
IFBBUkFNX0ZMQUcyKCJmZl9mbGFnMl9zdHJpY3RfZ29wIixDT0RFQ19GTEFHMl9TVFJJQ1RfR09Q
KTsKKyNlbmRpZgogCiAjaWYgTElCQVZDT0RFQ19WRVJTSU9OX01BSk9SID49IDU0CiAgIFBBUkFN
X0RJQ1RfRkxBRygiZmZfZmxhZ19oMjYzcF9haXYiLCAiYWl2Iik7CkBAIC0yODgsNyArMzIxLDYg
QEAKICAgUEFSQU1fRkxBRygiZmZfZmxhZ19sb29wX2ZpbHRlciIsQ09ERUNfRkxBR19MT09QX0ZJ
TFRFUik7CiAgIFBBUkFNX0ZMQUcoImZmX2ZsYWdfY2xvc2VkX2dvcCIsQ09ERUNfRkxBR19DTE9T
RURfR09QKTsKICAgUEFSQU1fRkxBRzIoImZmX2ZsYWcyX2Zhc3QiLENPREVDX0ZMQUcyX0ZBU1Qp
OwotICBQQVJBTV9GTEFHMigiZmZfZmxhZzJfc3RyaWN0X2dvcCIsQ09ERUNfRkxBRzJfU1RSSUNU
X0dPUCk7CiAgIFBBUkFNX0VOVU0oImZmX2NvZGVyX3R5cGUiLGNvZGVyX3R5cGUsY29kZXJfdHlw
ZSk7CiAgIAogICB9Ci0tLSBhL3BsdWdpbnMvZmZtcGVnL3ZpZGVvLmMJMjAxMi0wMi0yNSAyMDo0
Njo1Ni4wMDAwMDAwMDAgKzAxMDAKKysrIGIvcGx1Z2lucy9mZm1wZWcvdmlkZW8uYwkyMDE2LTAy
LTE1IDE2OjE3OjA5Ljk4MjQxNTUwNyArMDEwMApAQCAtMzcsMTAgKzM3LDEwIEBACiAjZW5kaWYK
IAogCi0jaWZkZWYgIFBJWF9GTVRfWVVWNDIyUDEwCi0jZGVmaW5lIFBJWF9GTVRfWVVWNDIyUDEw
X09SX0RVTU1ZIFBJWF9GTVRfWVVWNDIyUDEwCisjaWZkZWYgIEFWX1BJWF9GTVRfWVVWNDIyUDEw
CisjZGVmaW5lIEFWX1BJWF9GTVRfWVVWNDIyUDEwX09SX0RVTU1ZIEFWX1BJWF9GTVRfWVVWNDIy
UDEwCiAjZWxzZQotI2RlZmluZSBQSVhfRk1UX1lVVjQyMlAxMF9PUl9EVU1NWSAtMTIzNAorI2Rl
ZmluZSBBVl9QSVhfRk1UX1lVVjQyMlAxMF9PUl9EVU1NWSAtMTIzNAogI2VuZGlmCiAKICNpZiBM
SUJBVkNPREVDX1ZFUlNJT05fSU5UID49ICgoNTQ8PDE2KXwoMTw8OCl8MCkKQEAgLTkwLDkgKzkw
LDkgQEAKICAgaW50IGlteF9iaXRyYXRlOwogICBpbnQgaW14X3N0cmlwX3ZiaTsKIAotICAvKiBJ
biBzb21lIGNhc2VzIEZGTXBlZyB3b3VsZCByZXBvcnQgc29tZXRoaW5nIGxpa2UgUElYX0ZNVF9Z
VVY0MjJQLCB3aGlsZQotICAgICB3ZSB3b3VsZCBsaWtlIHRvIHRyZWF0IGl0IGFzIFBJWF9GTVRf
WVVWSjQyMlAuIEl0J3Mgb25seSB1c2VkIGZvciBkZWNvZGluZyAqLwotICBlbnVtIFBpeGVsRm9y
bWF0IHJlaW50ZXJwcmV0X3BpeF9mbXQ7CisgIC8qIEluIHNvbWUgY2FzZXMgRkZNcGVnIHdvdWxk
IHJlcG9ydCBzb21ldGhpbmcgbGlrZSBBVl9QSVhfRk1UX1lVVjQyMlAsIHdoaWxlCisgICAgIHdl
IHdvdWxkIGxpa2UgdG8gdHJlYXQgaXQgYXMgQVZfUElYX0ZNVF9ZVVZKNDIyUC4gSXQncyBvbmx5
IHVzZWQgZm9yIGRlY29kaW5nICovCisgIGVudW0gQVZQaXhlbEZvcm1hdCByZWludGVycHJldF9w
aXhfZm10OwogICAKICAgaW50IGlzX2lteDsKICAgaW50IHlfb2Zmc2V0OwpAQCAtMTM3LDQyICsx
MzcsNDIgQEAKIAogc3RhdGljIGNvbnN0IHN0cnVjdAogICB7Ci0gIGVudW0gUGl4ZWxGb3JtYXQg
ZmZtcGVnX2lkOworICBlbnVtIEFWUGl4ZWxGb3JtYXQgZmZtcGVnX2lkOwogICBpbnQgICAgICAg
ICAgICAgIGxxdF9pZDsKICAgaW50ICAgICAgICAgICAgICBleGFjdDsKICAgfQogY29sb3Jtb2Rl
bHNbXSA9CiAgIHsKLSAgICB7IFBJWF9GTVRfWVVWNDIwUCwgICBCQ19ZVVY0MjBQLCAgIDEgfSwg
Ly8vPCBQbGFuYXIgWVVWIDQ6MjowICgxIENyICYgQ2Igc2FtcGxlIHBlciAyeDIgWSBzYW1wbGVz
KQorICAgIHsgQVZfUElYX0ZNVF9ZVVY0MjBQLCAgIEJDX1lVVjQyMFAsICAgMSB9LCAvLy88IFBs
YW5hciBZVVYgNDoyOjAgKDEgQ3IgJiBDYiBzYW1wbGUgcGVyIDJ4MiBZIHNhbXBsZXMpCiAjaWYg
TElCQVZVVElMX1ZFUlNJT05fSU5UIDwgKDUwPDwxNikKLSAgICB7IFBJWF9GTVRfWVVWNDIyLCAg
ICBCQ19ZVVY0MjIsICAgIDEgfSwKKyAgICB7IEFWX1BJWF9GTVRfWVVWNDIyLCAgICBCQ19ZVVY0
MjIsICAgIDEgfSwKICNlbHNlCi0gICAgeyBQSVhfRk1UX1lVWVY0MjIsICAgQkNfWVVWNDIyLCAg
ICAxIH0sCisgICAgeyBBVl9QSVhfRk1UX1lVWVY0MjIsICAgQkNfWVVWNDIyLCAgICAxIH0sCiAj
ZW5kaWYKLSAgICB7IFBJWF9GTVRfUkdCMjQsICAgICBCQ19SR0I4ODgsICAgIDEgfSwgLy8vPCBQ
YWNrZWQgcGl4ZWwsIDMgYnl0ZXMgcGVyIHBpeGVsLCBSR0JSR0IuLi4KLSAgICB7IFBJWF9GTVRf
QkdSMjQsICAgICBCQ19CR1I4ODgsICAgIDEgfSwgLy8vPCBQYWNrZWQgcGl4ZWwsIDMgYnl0ZXMg
cGVyIHBpeGVsLCBCR1JCR1IuLi4KLSAgICB7IFBJWF9GTVRfWVVWNDIyUCwgICBCQ19ZVVY0MjJQ
LCAgIDEgfSwgLy8vPCBQbGFuYXIgWVVWIDQ6MjoyICgxIENyICYgQ2Igc2FtcGxlIHBlciAyeDEg
WSBzYW1wbGVzKQotICAgIHsgUElYX0ZNVF9ZVVY0NDRQLCAgIEJDX1lVVjQ0NFAsICAgMSB9LCAv
Ly88IFBsYW5hciBZVVYgNDo0OjQgKDEgQ3IgJiBDYiBzYW1wbGUgcGVyIDF4MSBZIHNhbXBsZXMp
Ci0gICAgeyBQSVhfRk1UX1lVVjQxMVAsICAgQkNfWVVWNDExUCwgICAxIH0sIC8vLzwgUGxhbmFy
IFlVViA0OjE6MSAoMSBDciAmIENiIHNhbXBsZSBwZXIgNHgxIFkgc2FtcGxlcykKLSAgICB7IFBJ
WF9GTVRfWVVWNDIyUDE2LCBCQ19ZVVY0MjJQMTYsIDEgfSwgLy8vPCBQbGFuYXIgMTYgYml0IFlV
ViA0OjI6MiAoMSBDciAmIENiIHNhbXBsZSBwZXIgMngxIFkgc2FtcGxlcykKLSNpZmRlZiBQSVhf
Rk1UX1lVVjQyMlAxMAotICAgIHsgUElYX0ZNVF9ZVVY0MjJQMTAsIEJDX1lVVjQyMlAxMCwgMSB9
LCAvLy88IDEwIGJpdCBzYW1wbGVzIGluIHVpbnQxNl90IGNvbnRhaW5lcnMsIHBsYW5hciA0OjI6
MgotI2VuZGlmCi0gICAgeyBQSVhfRk1UX1JHQjU2NSwgICAgQkNfUkdCNTY1LCAgICAxIH0sIC8v
LzwgYWx3YXlzIHN0b3JlZCBpbiBjcHUgZW5kaWFubmVzcwotICAgIHsgUElYX0ZNVF9ZVVZKNDIw
UCwgIEJDX1lVVko0MjBQLCAgMSB9LCAvLy88IFBsYW5hciBZVVYgNDoyOjAgZnVsbCBzY2FsZSAo
anBlZykKLSAgICB7IFBJWF9GTVRfWVVWSjQyMlAsICBCQ19ZVVZKNDIyUCwgIDEgfSwgLy8vPCBQ
bGFuYXIgWVVWIDQ6MjoyIGZ1bGwgc2NhbGUgKGpwZWcpCi0gICAgeyBQSVhfRk1UX1lVVko0NDRQ
LCAgQkNfWVVWSjQ0NFAsICAxIH0sIC8vLzwgUGxhbmFyIFlVViA0OjQ6NCBmdWxsIHNjYWxlIChq
cGVnKQorICAgIHsgQVZfUElYX0ZNVF9SR0IyNCwgICAgIEJDX1JHQjg4OCwgICAgMSB9LCAvLy88
IFBhY2tlZCBwaXhlbCwgMyBieXRlcyBwZXIgcGl4ZWwsIFJHQlJHQi4uLgorICAgIHsgQVZfUElY
X0ZNVF9CR1IyNCwgICAgIEJDX0JHUjg4OCwgICAgMSB9LCAvLy88IFBhY2tlZCBwaXhlbCwgMyBi
eXRlcyBwZXIgcGl4ZWwsIEJHUkJHUi4uLgorICAgIHsgQVZfUElYX0ZNVF9ZVVY0MjJQLCAgIEJD
X1lVVjQyMlAsICAgMSB9LCAvLy88IFBsYW5hciBZVVYgNDoyOjIgKDEgQ3IgJiBDYiBzYW1wbGUg
cGVyIDJ4MSBZIHNhbXBsZXMpCisgICAgeyBBVl9QSVhfRk1UX1lVVjQ0NFAsICAgQkNfWVVWNDQ0
UCwgICAxIH0sIC8vLzwgUGxhbmFyIFlVViA0OjQ6NCAoMSBDciAmIENiIHNhbXBsZSBwZXIgMXgx
IFkgc2FtcGxlcykKKyAgICB7IEFWX1BJWF9GTVRfWVVWNDExUCwgICBCQ19ZVVY0MTFQLCAgIDEg
fSwgLy8vPCBQbGFuYXIgWVVWIDQ6MToxICgxIENyICYgQ2Igc2FtcGxlIHBlciA0eDEgWSBzYW1w
bGVzKQorICAgIHsgQVZfUElYX0ZNVF9ZVVY0MjJQMTYsIEJDX1lVVjQyMlAxNiwgMSB9LCAvLy88
IFBsYW5hciAxNiBiaXQgWVVWIDQ6MjoyICgxIENyICYgQ2Igc2FtcGxlIHBlciAyeDEgWSBzYW1w
bGVzKQorI2lmZGVmIEFWX1BJWF9GTVRfWVVWNDIyUDEwCisgICAgeyBBVl9QSVhfRk1UX1lVVjQy
MlAxMCwgQkNfWVVWNDIyUDEwLCAxIH0sIC8vLzwgMTAgYml0IHNhbXBsZXMgaW4gdWludDE2X3Qg
Y29udGFpbmVycywgcGxhbmFyIDQ6MjoyCisjZW5kaWYKKyAgICB7IEFWX1BJWF9GTVRfUkdCNTY1
LCAgICBCQ19SR0I1NjUsICAgIDEgfSwgLy8vPCBhbHdheXMgc3RvcmVkIGluIGNwdSBlbmRpYW5u
ZXNzCisgICAgeyBBVl9QSVhfRk1UX1lVVko0MjBQLCAgQkNfWVVWSjQyMFAsICAxIH0sIC8vLzwg
UGxhbmFyIFlVViA0OjI6MCBmdWxsIHNjYWxlIChqcGVnKQorICAgIHsgQVZfUElYX0ZNVF9ZVVZK
NDIyUCwgIEJDX1lVVko0MjJQLCAgMSB9LCAvLy88IFBsYW5hciBZVVYgNDoyOjIgZnVsbCBzY2Fs
ZSAoanBlZykKKyAgICB7IEFWX1BJWF9GTVRfWVVWSjQ0NFAsICBCQ19ZVVZKNDQ0UCwgIDEgfSwg
Ly8vPCBQbGFuYXIgWVVWIDQ6NDo0IGZ1bGwgc2NhbGUgKGpwZWcpCiAjaWYgTElCQVZVVElMX1ZF
UlNJT05fSU5UIDwgKDUwPDwxNikKLSAgICB7IFBJWF9GTVRfUkdCQTMyLCAgICBCQ19SR0JBODg4
OCwgIDAgfSwgLy8vPCBQYWNrZWQgcGl4ZWwsIDQgYnl0ZXMgcGVyIHBpeGVsLCBCR1JBQkdSQS4u
LgorICAgIHsgQVZfUElYX0ZNVF9SR0JBMzIsICAgIEJDX1JHQkE4ODg4LCAgMCB9LCAvLy88IFBh
Y2tlZCBwaXhlbCwgNCBieXRlcyBwZXIgcGl4ZWwsIEJHUkFCR1JBLi4uCiAjZWxzZQotICAgIHsg
UElYX0ZNVF9SR0IzMiwgICAgIEJDX1JHQkE4ODg4LCAgMCB9LCAvLy88IFBhY2tlZCBwaXhlbCwg
NCBieXRlcyBwZXIgcGl4ZWwsIEJHUkFCR1JBLi4uCisgICAgeyBBVl9QSVhfRk1UX1JHQjMyLCAg
ICAgQkNfUkdCQTg4ODgsICAwIH0sIC8vLzwgUGFja2VkIHBpeGVsLCA0IGJ5dGVzIHBlciBwaXhl
bCwgQkdSQUJHUkEuLi4KICNlbmRpZgotICAgIHsgUElYX0ZNVF9SR0I1NTUsICAgIEJDX1JHQjg4
OCwgICAgMCB9LCAvLy88IGFsd2F5cyBzdG9yZWQgaW4gY3B1IGVuZGlhbm5lc3MsIG1vc3Qgc2ln
bmlmaWNhbnQgYml0IHRvIDEKLSAgICB7IFBJWF9GTVRfR1JBWTgsICAgICBCQ19SR0I4ODgsICAg
IDAgfSwKLSAgICB7IFBJWF9GTVRfTU9OT1dISVRFLCBCQ19SR0I4ODgsICAgIDAgfSwgLy8vPCAw
IGlzIHdoaXRlCi0gICAgeyBQSVhfRk1UX01PTk9CTEFDSywgQkNfUkdCODg4LCAgICAwIH0sIC8v
LzwgMCBpcyBibGFjawotICAgIHsgUElYX0ZNVF9QQUw4LCAgICAgIEJDX1JHQjg4OCwgICAgMCB9
LCAvLy88IDggYml0IHdpdGggUkdCQSBwYWxldHRlCi0gICAgeyBQSVhfRk1UX1lVVjQxMFAsICAg
QkNfWVVWNDIwUCwgICAwIH0sIC8vLzwgUGxhbmFyIFlVViA0OjE6MCAoMSBDciAmIENiIHNhbXBs
ZSBwZXIgNHg0IFkgc2FtcGxlcykKKyAgICB7IEFWX1BJWF9GTVRfUkdCNTU1LCAgICBCQ19SR0I4
ODgsICAgIDAgfSwgLy8vPCBhbHdheXMgc3RvcmVkIGluIGNwdSBlbmRpYW5uZXNzLCBtb3N0IHNp
Z25pZmljYW50IGJpdCB0byAxCisgICAgeyBBVl9QSVhfRk1UX0dSQVk4LCAgICAgQkNfUkdCODg4
LCAgICAwIH0sCisgICAgeyBBVl9QSVhfRk1UX01PTk9XSElURSwgQkNfUkdCODg4LCAgICAwIH0s
IC8vLzwgMCBpcyB3aGl0ZQorICAgIHsgQVZfUElYX0ZNVF9NT05PQkxBQ0ssIEJDX1JHQjg4OCwg
ICAgMCB9LCAvLy88IDAgaXMgYmxhY2sKKyAgICB7IEFWX1BJWF9GTVRfUEFMOCwgICAgICBCQ19S
R0I4ODgsICAgIDAgfSwgLy8vPCA4IGJpdCB3aXRoIFJHQkEgcGFsZXR0ZQorICAgIHsgQVZfUElY
X0ZNVF9ZVVY0MTBQLCAgIEJDX1lVVjQyMFAsICAgMCB9LCAvLy88IFBsYW5hciBZVVYgNDoxOjAg
KDEgQ3IgJiBDYiBzYW1wbGUgcGVyIDR4NCBZIHNhbXBsZXMpCiAgIH07CiAKIHN0YXRpYyBjb25z
dCBzdHJ1Y3QKQEAgLTM0MywxNiArMzQzLDE2IEBACiAgIGlmICghY29kZWMtPnBpeF9mbXRzKQog
ICAgIHJldHVybiAwOwogCi0gIGZvciAoaSA9IDA7IGNvZGVjLT5waXhfZm10c1tpXSAhPSBQSVhf
Rk1UX05PTkU7ICsraSkKKyAgZm9yIChpID0gMDsgY29kZWMtPnBpeF9mbXRzW2ldICE9IEFWX1BJ
WF9GTVRfTk9ORTsgKytpKQogICAgIHsKLSAgICBpZiAoY29kZWMtPnBpeF9mbXRzW2ldID09IFBJ
WF9GTVRfWVVWNDIyUDEwX09SX0RVTU1ZKQorICAgIGlmIChjb2RlYy0+cGl4X2ZtdHNbaV0gPT0g
QVZfUElYX0ZNVF9ZVVY0MjJQMTBfT1JfRFVNTVkpCiAgICAgICByZXR1cm4gMTsKICAgICB9CiAK
ICAgcmV0dXJuIDA7CiAgIH0KIAotc3RhdGljIGVudW0gUGl4ZWxGb3JtYXQgbHF0X2ZmbXBlZ19n
ZXRfZmZtcGVnX2NvbG9ybW9kZWwoaW50IGlkKQorc3RhdGljIGVudW0gQVZQaXhlbEZvcm1hdCBs
cXRfZmZtcGVnX2dldF9mZm1wZWdfY29sb3Jtb2RlbChpbnQgaWQpCiAgIHsKICAgaW50IGk7CiAK
QEAgLTM2MSwxMCArMzYxLDEwIEBACiAgICAgaWYoY29sb3Jtb2RlbHNbaV0ubHF0X2lkID09IGlk
KQogICAgICAgcmV0dXJuIGNvbG9ybW9kZWxzW2ldLmZmbXBlZ19pZDsKICAgICB9Ci0gIHJldHVy
biBQSVhfRk1UX05COworICByZXR1cm4gQVZfUElYX0ZNVF9OQjsKICAgfQogCi1zdGF0aWMgaW50
IGxxdF9mZm1wZWdfZ2V0X2xxdF9jb2xvcm1vZGVsKGVudW0gUGl4ZWxGb3JtYXQgaWQsIGludCAq
IGV4YWN0KQorc3RhdGljIGludCBscXRfZmZtcGVnX2dldF9scXRfY29sb3Jtb2RlbChlbnVtIEFW
UGl4ZWxGb3JtYXQgaWQsIGludCAqIGV4YWN0KQogICB7CiAgIGludCBpOwogCkBAIC00MDAsMjYg
KzQwMCwyNiBAQAogICBjb2RlYy0+cmVpbnRlcnByZXRfcGl4X2ZtdCA9IGNvZGVjLT5hdmN0eC0+
cGl4X2ZtdDsKIAogICAvKiBGaXJzdCB3ZSB0cnkgY29kZWMtc3BlY2lmaWMgY29sb3Jtb2RlbCBt
YXRjaGluZy4gKi8KLSAgaWYoY29kZWMtPmRlY29kZXItPmlkID09IENPREVDX0lEX0ROWEhEKQor
ICBpZihjb2RlYy0+ZGVjb2Rlci0+aWQgPT0gQVZfQ09ERUNfSURfRE5YSEQpCiAgICAgewotICAg
IC8qIEZGTXBlZyBzdXBwb3J0cyBQSVhfRk1UX1lVVjQyMlAgYW5kIFBJWF9GTVRfWVVWNDIyUDEw
IGZvciBETnhIRCwgd2hpY2gKLSAgICAgICB3ZSBzb21ldGltZXMgaW50ZXJwcmV0IGFzIFBJWF9G
TVRfWVVWSjQyMlAgYW5kIFBJWF9GTVRfWVVWSjQyMlAxMC4gKi8KLSAgICBpZiAoY29kZWMtPmF2
Y3R4LT5waXhfZm10ID09IFBJWF9GTVRfWVVWNDIyUCB8fCBjb2RlYy0+YXZjdHgtPnBpeF9mbXQg
PT0gUElYX0ZNVF9ZVVY0MjJQMTBfT1JfRFVNTVkpCisgICAgLyogRkZNcGVnIHN1cHBvcnRzIEFW
X1BJWF9GTVRfWVVWNDIyUCBhbmQgQVZfUElYX0ZNVF9ZVVY0MjJQMTAgZm9yIEROeEhELCB3aGlj
aAorICAgICAgIHdlIHNvbWV0aW1lcyBpbnRlcnByZXQgYXMgQVZfUElYX0ZNVF9ZVVZKNDIyUCBh
bmQgQVZfUElYX0ZNVF9ZVVZKNDIyUDEwLiAqLworICAgIGlmIChjb2RlYy0+YXZjdHgtPnBpeF9m
bXQgPT0gQVZfUElYX0ZNVF9ZVVY0MjJQIHx8IGNvZGVjLT5hdmN0eC0+cGl4X2ZtdCA9PSBBVl9Q
SVhfRk1UX1lVVjQyMlAxMF9PUl9EVU1NWSkKICAgICAgIHsKLSAgICAgIGludCBwMTAgPSAoY29k
ZWMtPmF2Y3R4LT5waXhfZm10ID09IFBJWF9GTVRfWVVWNDIyUDEwX09SX0RVTU1ZKTsKKyAgICAg
IGludCBwMTAgPSAoY29kZWMtPmF2Y3R4LT5waXhfZm10ID09IEFWX1BJWF9GTVRfWVVWNDIyUDEw
X09SX0RVTU1ZKTsKICAgICAgICpleGFjdCA9IDE7CiAgICAgICBpZiAobHF0X2ZmbXBlZ19nZXRf
YXZpZF95dXZfcmFuZ2UodnRyYWNrLT50cmFjaykgPT0gQVZJRF9GVUxMX1lVVl9SQU5HRSkKICAg
ICAgICAgewogICAgICAgICB2dHJhY2stPnN0cmVhbV9jbW9kZWwgPSBwMTAgPyBCQ19ZVVZKNDIy
UDEwIDogQkNfWVVWSjQyMlA7Ci0gICAgICAgIGNvZGVjLT5yZWludGVycHJldF9waXhfZm10ID0g
cDEwID8gUElYX0ZNVF9ZVVY0MjJQMTBfT1JfRFVNTVkgOiBQSVhfRk1UX1lVVko0MjJQOwotICAg
ICAgICAvLyBOb3RlOiByZWludGVycHJldF9waXhfZm10IHNob3VsZCByZWFsbHkgYmUgUElYX0ZN
VF9ZVVZKNDIyUDEwLCBleGNlcHQKKyAgICAgICAgY29kZWMtPnJlaW50ZXJwcmV0X3BpeF9mbXQg
PSBwMTAgPyBBVl9QSVhfRk1UX1lVVjQyMlAxMF9PUl9EVU1NWSA6IEFWX1BJWF9GTVRfWVVWSjQy
MlA7CisgICAgICAgIC8vIE5vdGU6IHJlaW50ZXJwcmV0X3BpeF9mbXQgc2hvdWxkIHJlYWxseSBi
ZSBBVl9QSVhfRk1UX1lVVko0MjJQMTAsIGV4Y2VwdAogICAgICAgICAvLyB0aGVyZSBpcyBubyBz
dWNoIGNvbG9ybW9kZWwgaW4gRkZNcGVnLiBGb3J0dW5hdGVseSwgaXQncyBub3QgYSBwcm9ibGVt
CiAgICAgICAgIC8vIGluIHRoaXMgY2FzZSwgYXMgcmVpbnRlcnByZXRfcGl4X2ZtdCBpcyBvbmx5
IHVzZWQgd2hlbiAqZXhhY3QgPT0gMC4KICAgICAgICAgfQogICAgICAgZWxzZQogICAgICAgICB7
CiAgICAgICAgIHZ0cmFjay0+c3RyZWFtX2Ntb2RlbCA9IHAxMCA/IEJDX1lVVjQyMlAxMCA6IEJD
X1lVVjQyMlA7Ci0gICAgICAgIGNvZGVjLT5yZWludGVycHJldF9waXhfZm10ID0gcDEwID8gUElY
X0ZNVF9ZVVY0MjJQMTBfT1JfRFVNTVkgOiBQSVhfRk1UX1lVVjQyMlA7CisgICAgICAgIGNvZGVj
LT5yZWludGVycHJldF9waXhfZm10ID0gcDEwID8gQVZfUElYX0ZNVF9ZVVY0MjJQMTBfT1JfRFVN
TVkgOiBBVl9QSVhfRk1UX1lVVjQyMlA7CiAgICAgICAgIH0KICAgICAgIHJldHVybjsKICAgICAg
IH0KQEAgLTQzOCwxNiArNDM4LDE2IEBACiAgIHF1aWNrdGltZV9mZm1wZWdfdmlkZW9fY29kZWNf
dCAqY29kZWMgPSB2dHJhY2stPmNvZGVjLT5wcml2OwogICBjb2RlYy0+YXZjdHgtPnBpeF9mbXQg
PSBscXRfZmZtcGVnX2dldF9mZm1wZWdfY29sb3Jtb2RlbCh2dHJhY2stPnN0cmVhbV9jbW9kZWwp
OwogCi0gIGlmIChjb2RlYy0+ZW5jb2Rlci0+aWQgPT0gQ09ERUNfSURfRE5YSEQpCisgIGlmIChj
b2RlYy0+ZW5jb2Rlci0+aWQgPT0gQVZfQ09ERUNfSURfRE5YSEQpCiAgICAgewotICAgIC8qIEZG
TXBlZydzIEROeEhEIGVuY29kZXIgb25seSBzdXBwb3J0cyBQSVhfRk1UX1lVVjQyMlAgYW5kIFBJ
WF9GTVRfWVVWNDIyUDEwCi0gICAgICAgYW5kIGRvZXNuJ3Qga25vdyBhbnl0aGluZyBhYm91dCBQ
SVhfRk1UX1lVVko0MjJQIGFuZCBQSVhfRk1UX1lVVko0MjJQMTAKKyAgICAvKiBGRk1wZWcncyBE
TnhIRCBlbmNvZGVyIG9ubHkgc3VwcG9ydHMgQVZfUElYX0ZNVF9ZVVY0MjJQIGFuZCBBVl9QSVhf
Rk1UX1lVVjQyMlAxMAorICAgICAgIGFuZCBkb2Vzbid0IGtub3cgYW55dGhpbmcgYWJvdXQgQVZf
UElYX0ZNVF9ZVVZKNDIyUCBhbmQgQVZfUElYX0ZNVF9ZVVZKNDIyUDEwCiAgICAgICAgKGluIGZh
Y3QsIHRoZSBsYXR0ZXIgZG9lc24ndCBldmVuIGV4aXN0KSAqLwotICAgIGNvZGVjLT5hdmN0eC0+
cGl4X2ZtdCA9IFBJWF9GTVRfWVVWNDIyUDsKKyAgICBjb2RlYy0+YXZjdHgtPnBpeF9mbXQgPSBB
Vl9QSVhfRk1UX1lVVjQyMlA7CiAgICAgaWYgKHZ0cmFjay0+c3RyZWFtX2Ntb2RlbCA9PSBCQ19Z
VVY0MjJQMTAgfHwgdnRyYWNrLT5zdHJlYW1fY21vZGVsID09IEJDX1lVVko0MjJQMTApCiAgICAg
ICB7CiAgICAgICBpZiAobHF0X3RlbmJpdF9kbnhoZF9zdXBwb3J0ZWQoY29kZWMtPmVuY29kZXIp
KQotICAgICAgICBjb2RlYy0+YXZjdHgtPnBpeF9mbXQgPSBQSVhfRk1UX1lVVjQyMlAxMF9PUl9E
VU1NWTsKKyAgICAgICAgY29kZWMtPmF2Y3R4LT5waXhfZm10ID0gQVZfUElYX0ZNVF9ZVVY0MjJQ
MTBfT1JfRFVNTVk7CiAgICAgICB9CiAgICAgfQogICB9CkBAIC00NTgsNyArNDU4LDcgQEAKIC8q
IEZyb20gYXZjb2RlYy5oOiAqLwogCiAvKgotICogUElYX0ZNVF9SR0JBMzIgaXMgaGFuZGxlZCBp
biBhbiBlbmRpYW4tc3BlY2lmaWMgbWFubmVyLiBBIFJHQkEKKyAqIEFWX1BJWF9GTVRfUkdCQTMy
IGlzIGhhbmRsZWQgaW4gYW4gZW5kaWFuLXNwZWNpZmljIG1hbm5lci4gQSBSR0JBCiAgKiBjb2xv
ciBpcyBwdXQgdG9nZXRoZXIgYXM6CiAgKiAgKEEgPDwgMjQpIHwgKFIgPDwgMTYpIHwgKEcgPDwg
OCkgfCBCCiAgKiBUaGlzIGlzIHN0b3JlZCBhcyBCR1JBIG9uIGxpdHRsZSBlbmRpYW4gQ1BVIGFy
Y2hpdGVjdHVyZXMgYW5kIEFSR0Igb24KQEAgLTUzMCw3ICs1MzAsNyBAQAogICovCiAKIHN0YXRp
YyB2b2lkIGNvbnZlcnRfaW1hZ2VfZGVjb2RlKHF1aWNrdGltZV9mZm1wZWdfdmlkZW9fY29kZWNf
dCAqY29kZWMsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBVkZyYW1lICogaW5f
ZnJhbWUsIGVudW0gUGl4ZWxGb3JtYXQgaW5fZm9ybWF0LAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgQVZGcmFtZSAqIGluX2ZyYW1lLCBlbnVtIEFWUGl4ZWxGb3JtYXQgaW5fZm9y
bWF0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgY2hhciAqKiBv
dXRfZnJhbWUsIGludCBvdXRfZm9ybWF0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgaW50IHdpZHRoLCBpbnQgaGVpZ2h0LCBpbnQgcm93X3NwYW4sIGludCByb3dfc3Bhbl91dikK
ICAgewpAQCAtNTQ3LDkgKzU0Nyw5IEBACiAgICAqICBSR0JBIGZvcm1hdCBsaWtlIGluIGZmbXBl
Zz8/CiAgICAqLwogI2lmIExJQkFWVVRJTF9WRVJTSU9OX0lOVCA8ICg1MDw8MTYpCi0gIGlmKChp
bl9mb3JtYXQgPT0gUElYX0ZNVF9SR0JBMzIpICYmIChvdXRfZm9ybWF0ID09IEJDX1JHQkE4ODg4
KSkKKyAgaWYoKGluX2Zvcm1hdCA9PSBBVl9QSVhfRk1UX1JHQkEzMikgJiYgKG91dF9mb3JtYXQg
PT0gQkNfUkdCQTg4ODgpKQogI2Vsc2UKLSAgICBpZigoaW5fZm9ybWF0ID09IFBJWF9GTVRfUkdC
MzIpICYmIChvdXRfZm9ybWF0ID09IEJDX1JHQkE4ODg4KSkKKyAgICBpZigoaW5fZm9ybWF0ID09
IEFWX1BJWF9GTVRfUkdCMzIpICYmIChvdXRfZm9ybWF0ID09IEJDX1JHQkE4ODg4KSkKICNlbmRp
ZgogICAgICAgewogICAgICAgY29udmVydF9pbWFnZV9kZWNvZGVfcmdiYShpbl9mcmFtZSwgb3V0
X2ZyYW1lLCB3aWR0aCwgaGVpZ2h0LCBjb2RlYy0+eV9vZmZzZXQpOwpAQCAtNzI4LDEzICs3Mjgs
MTMgQEAKIAogICAgIC8qIFNldCBleHRyYWRhdGE6IEl0J3MgZG9uZSBkaWZmZXJlbnRseSBmb3Ig
ZWFjaCBjb2RlYyAqLwogCi0gICAgaWYoY29kZWMtPmRlY29kZXItPmlkID09IENPREVDX0lEX1NW
UTMpCisgICAgaWYoY29kZWMtPmRlY29kZXItPmlkID09IEFWX0NPREVDX0lEX1NWUTMpCiAgICAg
ICB7CiAgICAgICBleHRyYWRhdGEgICAgICAgPSB0cmFrLT5tZGlhLm1pbmYuc3RibC5zdHNkLnRh
YmxlWzBdLnRhYmxlX3JhdyArIDQ7CiAgICAgICBleHRyYWRhdGFfc2l6ZSAgPSB0cmFrLT5tZGlh
Lm1pbmYuc3RibC5zdHNkLnRhYmxlWzBdLnRhYmxlX3Jhd19zaXplIC0gNDsKICAgICAgIAogICAg
ICAgfQotICAgIGVsc2UgaWYoY29kZWMtPmRlY29kZXItPmlkID09IENPREVDX0lEX0gyNjQpCisg
ICAgZWxzZSBpZihjb2RlYy0+ZGVjb2Rlci0+aWQgPT0gQVZfQ09ERUNfSURfSDI2NCkKICAgICAg
IHsKICAgICAgIHVzZXJfYXRvbSA9IHF1aWNrdGltZV9zdHNkX2dldF91c2VyX2F0b20odHJhaywg
ImF2Y0MiLCAmdXNlcl9hdG9tX2xlbik7CiAKQEAgLTc1Myw3ICs3NTMsNyBAQAogICAgICAgICB9
CiAgICAgICAKICAgICAgIH0KLSAgICBlbHNlIGlmKGNvZGVjLT5kZWNvZGVyLT5pZCA9PSBDT0RF
Q19JRF9NUEVHNCkKKyAgICBlbHNlIGlmKGNvZGVjLT5kZWNvZGVyLT5pZCA9PSBBVl9DT0RFQ19J
RF9NUEVHNCkKICAgICAgIHsKICAgICAgIGlmKHRyYWstPm1kaWEubWluZi5zdGJsLnN0c2QudGFi
bGVbMF0uaGFzX2VzZHMpCiAgICAgICAgIHsKQEAgLTgyOSw3ICs4MjksNyBAQAogICAgIGlmKGF2
Y29kZWNfb3BlbjIoY29kZWMtPmF2Y3R4LCBjb2RlYy0+ZGVjb2RlciwgTlVMTCkgIT0gMCkKICAg
ICAgIHJldHVybiAtMTsKICNlbmRpZgotICAgIGNvZGVjLT5mcmFtZSA9IGF2Y29kZWNfYWxsb2Nf
ZnJhbWUoKTsKKyAgICBjb2RlYy0+ZnJhbWUgPSBhdl9mcmFtZV9hbGxvYygpOwogICAgIHZ0cmFj
ay0+c3RyZWFtX2Ntb2RlbCA9IExRVF9DT0xPUk1PREVMX05PTkU7CiAgICAgY29kZWMtPmluaXRp
YWxpemVkID0gMTsKICAgICB9CkBAIC05MjksMTAgKzkyOSwxMCBAQAogI2lmZGVmIEhBVkVfTElC
U1dTQ0FMRQogCiAjaWYgTElCQVZVVElMX1ZFUlNJT05fSU5UIDwgKDUwPDwxNikKLSAgICAgIGlm
KCEoKGNvZGVjLT5hdmN0eC0+cGl4X2ZtdCA9PSBQSVhfRk1UX1JHQkEzMikgJiYKKyAgICAgIGlm
KCEoKGNvZGVjLT5hdmN0eC0+cGl4X2ZtdCA9PSBBVl9QSVhfRk1UX1JHQkEzMikgJiYKICAgICAg
ICAgICAgKHZ0cmFjay0+c3RyZWFtX2Ntb2RlbCA9PSBCQ19SR0JBODg4OCkpKQogI2Vsc2UKLSAg
ICAgICAgaWYoISgoY29kZWMtPmF2Y3R4LT5waXhfZm10ID09IFBJWF9GTVRfUkdCMzIpICYmCisg
ICAgICAgIGlmKCEoKGNvZGVjLT5hdmN0eC0+cGl4X2ZtdCA9PSBBVl9QSVhfRk1UX1JHQjMyKSAm
JgogICAgICAgICAgICAgICh2dHJhY2stPnN0cmVhbV9jbW9kZWwgPT0gQkNfUkdCQTg4ODgpKSkK
ICNlbmRpZgogICAgICAgICAgIHsKQEAgLTk0NywxNSArOTQ3LDE1IEBACiAgICAgICAgICAgfQog
I2VuZGlmCiAgICAgICB9Ci0gICAgaWYoY29kZWMtPmRlY29kZXItPmlkID09IENPREVDX0lEX0RW
VklERU8pCisgICAgaWYoY29kZWMtPmRlY29kZXItPmlkID09IEFWX0NPREVDX0lEX0RWVklERU8p
CiAgICAgICB7CiAgICAgICBpZih2dHJhY2stPnN0cmVhbV9jbW9kZWwgPT0gQkNfWVVWNDIwUCkK
ICAgICAgICAgdnRyYWNrLT5jaHJvbWFfcGxhY2VtZW50ID0gTFFUX0NIUk9NQV9QTEFDRU1FTlRf
RFZQQUw7CiAgICAgICB2dHJhY2stPmludGVybGFjZV9tb2RlID0gTFFUX0lOVEVSTEFDRV9CT1RU
T01fRklSU1Q7CiAgICAgICB2dHJhY2stPmNpLmlkID0gTFFUX0NPTVBSRVNTSU9OX0RWOwogICAg
ICAgfQotICAgIGVsc2UgaWYoKGNvZGVjLT5kZWNvZGVyLT5pZCA9PSBDT0RFQ19JRF9NUEVHNCkg
fHwKLSAgICAgICAgICAgIChjb2RlYy0+ZGVjb2Rlci0+aWQgPT0gQ09ERUNfSURfSDI2NCkpCisg
ICAgZWxzZSBpZigoY29kZWMtPmRlY29kZXItPmlkID09IEFWX0NPREVDX0lEX01QRUc0KSB8fAor
ICAgICAgICAgICAgKGNvZGVjLT5kZWNvZGVyLT5pZCA9PSBBVl9DT0RFQ19JRF9IMjY0KSkKICAg
ICAgIHsKICAgICAgIGlmKHZ0cmFjay0+c3RyZWFtX2Ntb2RlbCA9PSBCQ19ZVVY0MjBQKQogICAg
ICAgICB2dHJhY2stPmNocm9tYV9wbGFjZW1lbnQgPSBMUVRfQ0hST01BX1BMQUNFTUVOVF9NUEVH
MjsKQEAgLTEyOTksMTMgKzEyOTksMTMgQEAKICAgICB7CiAgICAgaWYodnRyYWNrLT5zdHJlYW1f
Y21vZGVsID09IEJDX1lVVjQyMFApCiAgICAgICB7Ci0gICAgICBpZihjb2RlYy0+ZW5jb2Rlci0+
aWQgPT0gQ09ERUNfSURfTVBFRzQpCisgICAgICBpZihjb2RlYy0+ZW5jb2Rlci0+aWQgPT0gQVZf
Q09ERUNfSURfTVBFRzQpCiAgICAgICAgIHsKICAgICAgICAgdnRyYWNrLT5jaHJvbWFfcGxhY2Vt
ZW50ID0gTFFUX0NIUk9NQV9QTEFDRU1FTlRfTVBFRzI7CiAgICAgICAgIC8qIGVuYWJsZSBpbnRl
cmxhY2VkIGVuY29kaW5nICovCiAgICAgICAgIHZ0cmFjay0+aW50ZXJsYWNlX21vZGUgPSBMUVRf
SU5URVJMQUNFX05PTkU7CiAgICAgICAgIH0KLSAgICAgIGVsc2UgaWYoY29kZWMtPmVuY29kZXIt
PmlkID09IENPREVDX0lEX0RWVklERU8pCisgICAgICBlbHNlIGlmKGNvZGVjLT5lbmNvZGVyLT5p
ZCA9PSBBVl9DT0RFQ19JRF9EVlZJREVPKQogICAgICAgICB7CiAgICAgICAgIHZ0cmFjay0+Y2hy
b21hX3BsYWNlbWVudCA9IExRVF9DSFJPTUFfUExBQ0VNRU5UX0RWUEFMOwogICAgICAgICB9CkBA
IC0xMzE4LDcgKzEzMTgsNyBAQAogICAgICAgICAKICAgaWYoIWNvZGVjLT5pbml0aWFsaXplZCkK
ICAgICB7Ci0gICAgY29kZWMtPmZyYW1lID0gYXZjb2RlY19hbGxvY19mcmFtZSgpOworICAgIGNv
ZGVjLT5mcmFtZSA9IGF2X2ZyYW1lX2FsbG9jKCk7CiAKICAgICAvKiB0aW1lX2Jhc2UgaXMgMS9m
cmFtZXJhdGUgZm9yIGNvbnN0YW50IGZyYW1lcmF0ZSAqLwogICAgICAgICAgIApAQCAtMTM0MCw3
ICsxMzQwLDcgQEAKICAgICBjb2RlYy0+YXZjdHgtPnNhbXBsZV9hc3BlY3RfcmF0aW8ubnVtID0g
cGl4ZWxfd2lkdGg7CiAgICAgY29kZWMtPmF2Y3R4LT5zYW1wbGVfYXNwZWN0X3JhdGlvLmRlbiA9
IHBpeGVsX2hlaWdodDsKICAgICAvKiBVc2UgZ2xvYmFsIGhlYWRlcnMgZm9yIG1wNHYgKi8KLSAg
ICBpZihjb2RlYy0+ZW5jb2Rlci0+aWQgPT0gQ09ERUNfSURfTVBFRzQpCisgICAgaWYoY29kZWMt
PmVuY29kZXItPmlkID09IEFWX0NPREVDX0lEX01QRUc0KQogICAgICAgewogICAgICAgaWYoIShm
aWxlLT5maWxlX3R5cGUgJiAoTFFUX0ZJTEVfQVZJfExRVF9GSUxFX0FWSV9PRE1MKSkpCiAgICAg
ICAgIHsKQEAgLTEzNjQsMTIgKzEzNjQsMTIgQEAKICAgICAgICAgfQogI2VuZGlmCiAgICAgICB9
Ci0gICAgZWxzZSBpZigoY29kZWMtPmVuY29kZXItPmlkID09IENPREVDX0lEX01TTVBFRzRWMykg
JiYgKHRyYWstPnN0cmwpICYmCisgICAgZWxzZSBpZigoY29kZWMtPmVuY29kZXItPmlkID09IEFW
X0NPREVDX0lEX01TTVBFRzRWMykgJiYgKHRyYWstPnN0cmwpICYmCiAgICAgICAgICAgICAhc3Ry
bmNtcCh0cmFrLT5zdHJsLT5zdHJmLmJoLmJpQ29tcHJlc3Npb24sICJESVYzIiwgNCkpCiAgICAg
ICB7CiAgICAgICBzdHJuY3B5KHRyYWstPnN0cmwtPnN0cmguZmNjSGFuZGxlciwgImRpdjMiLCA0
KTsKICAgICAgIH0KLSAgICBlbHNlIGlmKChjb2RlYy0+ZW5jb2Rlci0+aWQgPT0gQ09ERUNfSURf
SDI2MykgJiYKKyAgICBlbHNlIGlmKChjb2RlYy0+ZW5jb2Rlci0+aWQgPT0gQVZfQ09ERUNfSURf
SDI2MykgJiYKICAgICAgICAgICAgIChmaWxlLT5maWxlX3R5cGUgJiAoTFFUX0ZJTEVfTVA0fExR
VF9GSUxFXzNHUCkpKQogICAgICAgewogICAgICAgdWludDhfdCBkMjYzX2RhdGFbXSA9CkBAIC0x
MzgzLDcgKzEzODMsNyBAQAogICAgICAgc3RybmNweSh0cmFrLT5tZGlhLm1pbmYuc3RibC5zdHNk
LnRhYmxlWzBdLmZvcm1hdCwKICAgICAgICAgICAgICAgInMyNjMiLCA0KTsKICAgICAgIH0KLSAg
ICBlbHNlIGlmKGNvZGVjLT5lbmNvZGVyLT5pZCA9PSBDT0RFQ19JRF9GRlZIVUZGKQorICAgIGVs
c2UgaWYoY29kZWMtPmVuY29kZXItPmlkID09IEFWX0NPREVDX0lEX0ZGVkhVRkYpCiAgICAgICB7
CiAgICAgICBpZighKGZpbGUtPmZpbGVfdHlwZSAmIChMUVRfRklMRV9BVkl8TFFUX0ZJTEVfQVZJ
X09ETUwpKSkKICAgICAgICAgewpAQCAtMTM5MSwyMiArMTM5MSwyMiBAQAogICAgICAgICBjb2Rl
Yy0+d3JpdGVfZ2xvYmFsX2hlYWRlciA9IDE7CiAgICAgICAgIH0KICAgICAgIH0KLSAgICBlbHNl
IGlmKGNvZGVjLT5lbmNvZGVyLT5pZCA9PSBDT0RFQ19JRF9RVFJMRSkKKyAgICBlbHNlIGlmKGNv
ZGVjLT5lbmNvZGVyLT5pZCA9PSBBVl9DT0RFQ19JRF9RVFJMRSkKICAgICAgIHsKICAgICAgIGlm
KHZ0cmFjay0+c3RyZWFtX2Ntb2RlbCA9PSBCQ19SR0JBODg4OCkKICAgICAgICAgewogICAgICAg
ICAvKiBMaWJxdWlja3RpbWUgZG9lc24ndCBuYXRpdmVseSBzdXBwb3J0IGEgY29sb3IgbW9kZWwg
ZXF1aXZhbGVudAotICAgICAgICAgICB0byBQSVhfRk1UX0FSR0IsIHdoaWNoIGlzIHJlcXVpcmVk
IGZvciBRVFJMRSB3aXRoIGFscGhhIGNoYW5uZWwuCisgICAgICAgICAgIHRvIEFWX1BJWF9GTVRf
QVJHQiwgd2hpY2ggaXMgcmVxdWlyZWQgZm9yIFFUUkxFIHdpdGggYWxwaGEgY2hhbm5lbC4KICAg
ICAgICAgICAgU28sIHdlIHVzZSBCQ19SR0JBODg4OCBhbmQgZG8gYWQgaG9jIGNvbnZlcnNpb24g
YmVsb3cuICovCi0gICAgICAgIGNvZGVjLT5hdmN0eC0+cGl4X2ZtdCA9IFBJWF9GTVRfQVJHQjsK
KyAgICAgICAgY29kZWMtPmF2Y3R4LT5waXhfZm10ID0gQVZfUElYX0ZNVF9BUkdCOwogICAgICAg
ICB2dHJhY2stPnRyYWNrLT5tZGlhLm1pbmYuc3RibC5zdHNkLnRhYmxlWzBdLmRlcHRoID0gMzI7
CiAgICAgICAgIH0KICAgICAgIH0KLSAgICBlbHNlIGlmKGNvZGVjLT5lbmNvZGVyLT5pZCA9PSBD
T0RFQ19JRF9EVlZJREVPKQorICAgIGVsc2UgaWYoY29kZWMtPmVuY29kZXItPmlkID09IEFWX0NP
REVDX0lEX0RWVklERU8pCiAgICAgICB7CiAgICAgICBzZXRfZHZfZm91cmNjKHdpZHRoLCBoZWln
aHQsIHZ0cmFjay0+c3RyZWFtX2Ntb2RlbCwgdHJhayk7CiAgICAgICB9Ci0gICAgZWxzZSBpZihj
b2RlYy0+ZW5jb2Rlci0+aWQgPT0gQ09ERUNfSURfRE5YSEQpCisgICAgZWxzZSBpZihjb2RlYy0+
ZW5jb2Rlci0+aWQgPT0gQVZfQ09ERUNfSURfRE5YSEQpCiAgICAgICB7CiAgICAgICBpZih2dHJh
Y2stPmludGVybGFjZV9tb2RlICE9IExRVF9JTlRFUkxBQ0VfTk9ORSkKICAgICAgICAgewpAQCAt
MTQ2Nyw3ICsxNDY3LDcgQEAKICAgICB9CiAgIC8vICAgICAgICBjb2RlYy0+bHF0X2NvbG9ybW9k
ZWwgPSBmZm1lcGdfMl9scXQoY29kZWMtPmNvbS5mZmNvZGVjX2VuYyk7CiAKLSAgaWYoY29kZWMt
Pnlfb2Zmc2V0ICE9IDAgfHwgY29kZWMtPmF2Y3R4LT5waXhfZm10ID09IFBJWF9GTVRfQVJHQikK
KyAgaWYoY29kZWMtPnlfb2Zmc2V0ICE9IDAgfHwgY29kZWMtPmF2Y3R4LT5waXhfZm10ID09IEFW
X1BJWF9GTVRfQVJHQikKICAgICB7CiAgICAgaWYoIWNvZGVjLT50bXBfcm93cykKICAgICAgIHsK
QEAgLTE0OTIsNyArMTQ5Miw3IEBACiAgICAgICAgICAgICAgICAgICAgICAgICB2dHJhY2stPnN0
cmVhbV9jbW9kZWwsCiAgICAgICAgICAgICAgICAgICAgICAgICAwLCAwLCAwLCBjb2RlYy0+eV9v
ZmZzZXQpOwogICAgICAgfQotICAgIGVsc2UgaWYoY29kZWMtPmF2Y3R4LT5waXhfZm10ID09IFBJ
WF9GTVRfQVJHQikKKyAgICBlbHNlIGlmKGNvZGVjLT5hdmN0eC0+cGl4X2ZtdCA9PSBBVl9QSVhf
Rk1UX0FSR0IpCiAgICAgICB7CiAgICAgICBjb252ZXJ0X3JnYmFfdG9fYXJnYihyb3dfcG9pbnRl
cnNbMF0sIHZ0cmFjay0+c3RyZWFtX3Jvd19zcGFuLAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgY29kZWMtPnRtcF9yb3dzWzBdLCBjb2RlYy0+dG1wX3Jvd19zcGFuLApAQCAtMTU1OCwxMiAr
MTU1OCwxMiBAQAogICAKICNlbmRpZgogICAKLSAgaWYoIXdhc19pbml0aWFsaXplZCAmJiBjb2Rl
Yy0+ZW5jb2Rlci0+aWQgPT0gQ09ERUNfSURfRE5YSEQpCisgIGlmKCF3YXNfaW5pdGlhbGl6ZWQg
JiYgY29kZWMtPmVuY29kZXItPmlkID09IEFWX0NPREVDX0lEX0ROWEhEKQogICAgIHNldHVwX2F2
aWRfYXRvbXMoZmlsZSwgdnRyYWNrLCBjb2RlYy0+YnVmZmVyLCBieXRlc19lbmNvZGVkKTsKICAg
CiAgIGlmKGJ5dGVzX2VuY29kZWQpCiAgICAgewotICAgIGlmIChwdHMgPT0gQVZfTk9QVFNfVkFM
VUUgfHwgKGNvZGVjLT5lbmNvZGVyLT5pZCA9PSBDT0RFQ19JRF9ETlhIRCAmJiBwdHMgPT0gMCkp
CisgICAgaWYgKHB0cyA9PSBBVl9OT1BUU19WQUxVRSB8fCAoY29kZWMtPmVuY29kZXItPmlkID09
IEFWX0NPREVDX0lEX0ROWEhEICYmIHB0cyA9PSAwKSkKICAgICAgIHsKICAgICAgIC8qIFNvbWUg
Y29kZWNzIGRvbid0IGJvdGhlciBnZW5lcmF0aW5nIHByZXNlbnRhdGlvbiB0aW1lc3RhbXBzLgog
ICAgICAgICAgRkZNcGVnJ3MgRE54SEQgZW5jb2RlciBkb2Vzbid0IGV2ZW4gYm90aGVyIHRvIHNl
dCBpdCB0byBBVl9OT1BUU19WQUxVRS4gKi8KQEAgLTE1OTAsMTMgKzE1OTAsMTMgQEAKIAogICBp
Zihjb2RlYy0+d3JpdGVfZ2xvYmFsX2hlYWRlciAmJiAhY29kZWMtPmdsb2JhbF9oZWFkZXJfd3Jp
dHRlbikKICAgICB7Ci0gICAgaWYoY29kZWMtPmVuY29kZXItPmlkID09IENPREVDX0lEX0ZGVkhV
RkYpCisgICAgaWYoY29kZWMtPmVuY29kZXItPmlkID09IEFWX0NPREVDX0lEX0ZGVkhVRkYpCiAg
ICAgICB7CiAgICAgICBxdWlja3RpbWVfdXNlcl9hdG9tc19hZGRfYXRvbSgmdHJhay0+bWRpYS5t
aW5mLnN0Ymwuc3RzZC50YWJsZVswXS51c2VyX2F0b21zLAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgImdsYmwiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgY29kZWMtPmF2Y3R4LT5leHRyYWRhdGEsIGNvZGVjLT5hdmN0eC0+ZXh0cmFkYXRhX3NpemUg
KTsKICAgICAgIH0KLSAgICBlbHNlIGlmKGNvZGVjLT5lbmNvZGVyLT5pZCA9PSBDT0RFQ19JRF9N
UEVHNCkKKyAgICBlbHNlIGlmKGNvZGVjLT5lbmNvZGVyLT5pZCA9PSBBVl9DT0RFQ19JRF9NUEVH
NCkKICAgICAgIHsKICAgICAgIGludCBhZHZhbmNlZCA9IDA7CiAgICAgICBpZihjb2RlYy0+YXZj
dHgtPm1heF9iX2ZyYW1lcyB8fApAQCAtMTkwMywxOCArMTkwMywxOCBAQAogICAgIGNvZGVjX2Jh
c2UtPmVuY29kZV92aWRlbyA9IGxxdF9mZm1wZWdfZW5jb2RlX3ZpZGVvOwogICAgIGNvZGVjX2Jh
c2UtPnNldF9wYXNzID0gc2V0X3Bhc3NfZmZtcGVnOwogCi0gICAgaWYoZW5jb2Rlci0+aWQgPT0g
Q09ERUNfSURfTVBFRzQpCisgICAgaWYoZW5jb2Rlci0+aWQgPT0gQVZfQ09ERUNfSURfTVBFRzQp
CiAgICAgICB7CiAgICAgICBjb2RlY19iYXNlLT53cml0ZXNfY29tcHJlc3NlZCA9IHdyaXRlc19j
b21wcmVzc2VkX21wZWc0OwogICAgICAgY29kZWNfYmFzZS0+aW5pdF9jb21wcmVzc2VkICAgPSBp
bml0X2NvbXByZXNzZWRfbXBlZzQ7CiAgICAgICBjb2RlY19iYXNlLT53cml0ZV9wYWNrZXQgPSB3
cml0ZV9wYWNrZXRfbXBlZzQ7CiAgICAgICB9Ci0gICAgZWxzZSBpZihlbmNvZGVyLT5pZCA9PSBD
T0RFQ19JRF9NUEVHMlZJREVPKQorICAgIGVsc2UgaWYoZW5jb2Rlci0+aWQgPT0gQVZfQ09ERUNf
SURfTVBFRzJWSURFTykKICAgICAgIHsKICAgICAgIGNvZGVjX2Jhc2UtPndyaXRlc19jb21wcmVz
c2VkID0gd3JpdGVzX2NvbXByZXNzZWRfaW14OwogICAgICAgY29kZWNfYmFzZS0+aW5pdF9jb21w
cmVzc2VkICAgPSBpbml0X2NvbXByZXNzZWRfaW14OwogICAgICAgfQotICAgIGVsc2UgaWYoZW5j
b2Rlci0+aWQgPT0gQ09ERUNfSURfRFZWSURFTykKKyAgICBlbHNlIGlmKGVuY29kZXItPmlkID09
IEFWX0NPREVDX0lEX0RWVklERU8pCiAgICAgICB7CiAgICAgICBjb2RlY19iYXNlLT5pbml0X2Nv
bXByZXNzZWQgPSBpbml0X2NvbXByZXNzZWRfZHY7CiAgICAgICB9CkBAIC0xOTIyLDcgKzE5MjIs
NyBAQAogICAgIH0KICAgaWYoZGVjb2RlcikKICAgICB7Ci0gICAgaWYoZGVjb2Rlci0+aWQgPT0g
Q09ERUNfSURfSDI2NCkKKyAgICBpZihkZWNvZGVyLT5pZCA9PSBBVl9DT0RFQ19JRF9IMjY0KQog
ICAgICAgY29kZWNfYmFzZS0+cmVhZF9wYWNrZXQgPSByZWFkX3BhY2tldF9oMjY0OwogICAgIGNv
ZGVjX2Jhc2UtPmRlY29kZV92aWRlbyA9IGxxdF9mZm1wZWdfZGVjb2RlX3ZpZGVvOwogICAgIH0K
"  | base64 -d > $TMP/libquicktime-1.2.4-ffmpeg3-1.patch

patch -p1 -i $TMP/libquicktime-1.2.4-ffmpeg3-1.patch || exit 1

CFLAGS="$SLKCFLAGS" \
CXXFLAGS="$SLKCFLAGS" \
./configure \
  --prefix=/usr \
  --libdir=/usr/lib${LIBDIRSUFFIX} \
  --sysconfdir=/etc \
  --localstatedir=/var \
  --mandir=/usr/man \
  --docdir=/usr/doc/$PRGNAM-$VERSION \
  --enable-gpl \
  --with-libdv \
  --build=$ARCH-slackware-linux

echo 
echo "$VERDE"Compilando ..."$CIERRE"
sleep 1

make || exit 1
make install-strip DESTDIR=$PKG
}

###################################
## BLOQUE PRINCIPAL DE EJECUCION ##
###################################
# Si se cierra el script inesperadamente, ejecutar la funcion de limpieza
trap f_exitmode SIGHUP SIGINT

#Inicializamos las variables globales
f_variables
#Asignamos o detectamos arquitectura
f_arquitectura
#Comprobamos conexion a Internet
f_comprobarConexion
#Inicializamos las variables del script
F_variables
#Creamos directorio de trabajo
f_directorioTemporal
#Mostramos el mensaje de presentacion
f_presentacion
#Comprobamos updates del script
f_comprobarUpdates
#Comprobamos version instalada del paquete
f_versionInstalada
#Compronar dependencias
F_dependencias
#Si no existe el fichero se descargara
f_download
#Preparamos entorno
f_preparar
#Descomprimir fichero descargado y compilamos
F_compilar
#Creamos xzm , instalamos y salimos
f_tareasFinales